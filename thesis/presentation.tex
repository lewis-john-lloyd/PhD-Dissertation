\documentclass[compress,xcolor=table]{beamer}
\usepackage{multicol}
\usepackage{tikz}
\usepackage{IEEEtrantools}
\usetikzlibrary{shapes}
\usetikzlibrary{arrows}
\usetikzlibrary{patterns}
\usepackage{booktabs}
\usepackage{multirow}

\usepackage{algpseudocode}

\input{commandsmath}
\input{commandsgeneral}

\usetheme{Szeged}
\usecolortheme{beaver}
\setbeamertemplate{navigation symbols}{}

%----------------------------------------------------------------------------
%----------------------------------------------------------------------------
\title[Department of Nuclear Engineering and Engineering Physics]{Selective Spatial-Temporal Nonlinear Refinement For
Thermal-Hydraulic Safety Analysis Codes}
\author[Lloyd]{Lewis John Lloyd}
\institute[University of Wisconsin - Madison]
{
  Department of Nuclear Engineering and Engineering Physics \\
  University of Wisconsin - Madison
}
\date[Prelim Defense 2012]{Preliminary Defense, 2012}
\subject{Nuclear Engineering}

%----------------------------------------------------------------------------
%----------------------------------------------------------------------------

\begin{document}
%------------------------------------------------------------------------------
%------------------------------------------------------------------------------

%\AtBeginSubsection[]
%{
%\begin{frame}
%\tableofcontents[subsectionstyle=show/shaded/hide,sectionstyle=show/shaded]
%\end{frame}
%}

%------------------------------------------------------------------------------
%------------------------------------------------------------------------------
\frame{\titlepage}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\begin{multicols}{2}
\tableofcontents
\end{multicols}
\end{frame}
%------------------------------------------------------------------------------
%------------------------------------------------------------------------------
\section[Background and Introduction]{Background and Introduction}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Introduction}

\begin{itemize}
\item{Core Cooling during Postulated Accidents}
\item{Multi-phase Flow}
\end{itemize}

\end{frame}
%------------------------------------------------------------------------------
%------------------------------------------------------------------------------
\subsection[Geometry]{Geometry of Interest}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Hydrodynamic Components}
\begin{columns}
\column{0.65\textwidth}

\begin{itemize}
\item{Sections
\begin{itemize}
\item{Contain channels}
\item{Defines spatial discretization of channels within section.}
\item{Splitting and merging of channels occur at section boundaries.}
\end{itemize}
}
\item{Channels
\begin{itemize}
\item{Defines cross-sectional areas.}
\end{itemize}
}
\item{Gaps
\begin{itemize}
\item{Connect channels within a section.}
\item{Defines transverse length.}
\end{itemize}
}
\end{itemize}

\column{0.35\textwidth}
\begin{figure}[t]
\centering
\resizebox{!}{0.7\textheight}{
\begin{tikzpicture}
\draw [thick] (-2,-2) rectangle (-1,2);
\draw [thick] (1,-2) rectangle (2,2);
\draw [thick] (-0.5,3) rectangle (0.5,7);
\draw [thick] (-0.5,-7) rectangle (0.5,-3);
\draw [dashed] (-1.5,2.5) -- (1.5,2.5);
\draw [dashed](-1.5,-2.5) -- (1.5,-2.5);
\draw [dashed,<-] (0,3) -- (0,2.5);
\draw [dashed,->] (-1.5,2.5) -- (-1.5,2);
\draw [dashed,->] (1.5,2.5) -- (1.5,2);
\draw [dashed,->] (0,-2.5) -- (0,-3);
\draw [dashed,<-] (-1.5,-2) -- (-1.5,-2.5);
\draw [dashed,<-] (1.5,-2) -- (1.5,-2.5);
\foreach \y in {-1.5, -0.5, 0.5, 1.5}
	\draw [dashed, <->] (-1,\y) -- (1,\y);
\foreach \y in {-6,-5,-4,4,5,6}
	\draw (-0.5,\y) -- (0.5,\y);
\foreach \y in {-1,0,1}
	\draw (-2,\y) -- (-1,\y);
\foreach \y in {-1,0,1}
	\draw (1,\y) -- (2,\y);
\foreach \y/\ytext in {-5/ 1,0/ 2,5/ 3}
	\draw (2.2,\y) node [anchor=west] {\huge Section $\ytext$};
\end{tikzpicture}
}
\end{figure}

\end{columns}

\end{frame}
%------------------------------------------------------------------------------
%------------------------------------------------------------------------------
\subsection[Two-Phase Flow]{Two-Phase Flow}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Two-Phase Flow}

\begin{itemize}
\item{Three water fields: vapor, continuous liquid, and dispersed liquid.}
\item{\Ncg{} field.}
\item{Assumptions}
\item{One-dimensional flow: nine partial differential equations.
\begin{itemize}
\item{Four conservation of mass equations.}
\item{Three conservation of momentum equations.}
\item{Two conservation of energy equations.}
\end{itemize}
\item{$\displaystyle \frac{\partial \vec{y}}{\partial t} = \vec{e}(\vec{y})$}
}
\end{itemize}

\end{frame}
%------------------------------------------------------------------------------
%------------------------------------------------------------------------------
\subsection[Numeric Approximation]{Numerical Approximations}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Spatial Approximations}

\begin{columns}
\column{0.5\textwidth}

\begin{itemize}
\item{Staggered Grid:
\begin{itemize}
\item{Continuity volumes: mass and energy conservation equations}
\item{Momentum volumes: momentum conservation equations}
\end{itemize}
}
\item{Conserved quantities are constant over their respective volumes.}
\item{1st Order upwind at volume edges.}
\end{itemize}


\column{0.5\textwidth}
\begin{figure}
\centering
\resizebox{\textwidth}{!}{
\begin{tikzpicture}
\draw (-3,0) rectangle +(1,5);
\draw (3,0) rectangle +(1,5);
\draw (0,0) rectangle +(1,1) (0,1) rectangle +(1,1) (0, 2) rectangle +(1,1) (0,3) rectangle +(1,1) (0,4) rectangle +(1,1);
\draw[dashed] (3,-0.5) rectangle +(1,1) (3,0.5) rectangle +(1,1) (3,1.5) rectangle +(1,1) (3, 2.5) rectangle +(1,1) (3,3.5) rectangle +(1,1) (3,3.5) rectangle +(1,1) (3, 4.5) rectangle +(1,1) ;
\draw[dashed] (-3,0) -- (4,0);
\draw[dashed] (-3,5) -- (4,5);
\draw (-2.5,-1) node {\textbf{Channel}};
\draw (0.5,-1) node {\textbf{Continuity}};
\draw (0.5,-1.5) node {\textbf{Volumes}};
\draw (3.5,-1) node {\textbf{Momentum}};
\draw (3.5,-1.5) node {\textbf{Volumes}};
\end{tikzpicture}
}
\end{figure}
\end{columns}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Temporal Approximations}

Integrate conservation equations over a time-step.

\begin{columns}
\column{0.5\textwidth}
\begin{itemize}
\item{Single step method}
\item{Temporal integral defined by approximation $\dt{} \vec{E}^{*}$}
\item{Multistage or single-stage approximations to $\vec{E}^{*}$ are possible.}
\end{itemize}
\column{0.5\textwidth}
\begin{IEEEeqnarray}{rcl}
\int^{t^{n+1}}_{t^n}\frac{\partial \vec{y}}{\partial t}\mathrm{d}\tau & = & \int^{t^{n+1}}_{t^n}\vec{E}(\vec{y})\mathrm{d}\tau \nonumber \\
\vec{y}^{n+1} - \vec{y}^{n} & = & \int_{t^{n+1}}^{t^n}\vec{E}(\vec{y})\mathrm{d}\tau \nonumber  \\
\vec{y}^{n+1} - \vec{y}^{n} & = & \Delta t \vec{E}(\vec{y}^{*}) \nonumber  \\
\label{eqn:simple_partial_t}
\frac{\vec{y}^{n+1} - \vec{y}^{n}}{\Delta t} & = & \vec{E}^{*} \nonumber \\
0 = \vec{y}^{n+1} & - & \vec{y}^{n} - \Delta t \vec{E}^{*} \nonumber
\end{IEEEeqnarray}

\end{columns}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Nonlinear Equations}

Residual: $\vec{F} = \vec{y}^{n+1} - \vec{y}^{n} - \dt{} \vec{E}^{*}$.

\begin{columns}
\column{0.7\textwidth}
\begin{itemize}
\item{Nine conservation equations require nine independent parameters.}
\item{$ \dot{m}_{k} = <\alpha_k \rho_k>_{a} u_{k} A_{m}$}
\item{$ P = P_{n} + P_{v} $}
\item{$ 1 = \alpha_g + \alpha_e + \alpha_l$}
\end{itemize}

\column{0.3\textwidth}
\begin{equation*}
\label{eqn:independent_variables}
\vec{x} = \begin{bmatrix}
\alpha_{g}P_{n}    \\
\alpha_g           \\
P                  \\
\alpha_e           \\
\alpha_g h_v       \\
(1 - \alpha_g) h_l \\
\dot{m}_g          \\
\dot{m}_l          \\
\dot{m}_e          \\
\end{bmatrix}
\end{equation*}
\end{columns}

Residual: $\vec{F}(\vec{x}^{n+1}) = \vec{y}(\vec{x}^{n+1}) - \vec{y}^{n} - \dt{} \vec{E}(\vec{x}^{*})$.


\end{frame}
%------------------------------------------------------------------------------
%------------------------------------------------------------------------------
\subsection[Solution Methods]{Solution Methods}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Methods}
\begin{itemize}
\item{Fully Explicit
\begin{itemize}
\item{Lowest computational cost per timestep}
\item{Subject to sonic CFL limit: $ \dt{} \lesssim \frac{\dx{}}{|u|+|c|}$}
\end{itemize}
}
\item{Fully Implicit Method
\begin{itemize}
\item{Highest computational cost per timestep.}
\item{Not subject to CFL limit.}
\item{Nonlinearly convergent}
\item{CATHARE (Barre and Bernard, 1990)}
\end{itemize}
}
\item{Semi-Implicit Method (Liles and Reed, 1978)
\begin{itemize}
\item{Single Newton step}
\item{Subject to material Courant limit: $ \dt{} \lesssim \frac{\dx{}}{|u|}$}
\item{RELAP, TRACE, COBRA, MARS, SPACE} 
\end{itemize}
}
\end{itemize}
\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Methods}
\begin{itemize}
\item{Stability-Enhancing Two-Step Method (SETS) (Mahaffy, 1982)
\begin{itemize}
\item{Multistage method}
\item{Nonlinearly convergent}
\item{Capable of exceeding material Courant limit}
\item{TRAC-M/Fortran 90, TRACE}
\end{itemize}
}
\item{Nearly Implicit Method (Trapp and Riemke, 1986)
\begin{itemize}
\item{Derivative of SETS method}
\item{Multistage method}
\item{Single Newton step}
\item{Capable of exceeding material Courant limit}
\item{RELAP}
\end{itemize}
}
\end{itemize}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Semi-Implicit Method}
Residual: $\vec{F}(\vec{x}^{n+1}) = \vec{y}(\vec{x}^{n+1}) - \vec{y}^{n} - \dt{} \vec{E}(\vec{x}^{n+1},\vec{x}^{n})$.

\begin{columns}
\column{0.45\textwidth}

\begin{itemize}
\item{Nonlinearities in $\vec{E}(\vec{x}^{*})$.}
\item{Material Courant limit: $ \Delta t \lesssim \frac{\Delta x}{|u|}$}
\item{TRACE, COBRA, RELAP, SPACE, MARS}
\end{itemize}

\column{0.5\textwidth}

\begin{algorithmic}
\scriptsize
\Require $\vec{x}^{0}$ and $t^{0}$
\Set $n = 0$
\Loop \; Transient Loop
    \State $t^{n+1} : = t^{n} + \Delta t$
	\Calculate $\vec{F}(\vec{x}^{n})$ and $\vec{J}(\vec{x}^{n})$
	\Calculate $\vec{\delta x} = - \vec{J}^{-1}\cdot\vec{F}$
	\Calculate $\vec{x}^{n+1} = \vec{x}^{n} + \vec{\delta x}$
\EndLoop{\; $n = n + 1$} 
\end{algorithmic}

\end{columns}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Semi-Implicit Continuous Liquid Mass and Momentum Equations}

Conservation of continuous liquid mass:
\begin{IEEEeqnarray}{rCl}
V_c ( (\alpha_l \rho_l )^{n+1} & - & (\alpha_l \rho_l )^{n} ) =  -\Delta t \sum_{NK}\left( <\alpha^n_l \rho^n_l>^{n}_{d} u^{n+1}_l  \cdot \vec{\bar{A}}\right) \nonumber \\
&- &\Delta t\left[(1-\eta)\Gamma + S \right]^{n+1} \nonumber
\end{IEEEeqnarray}

Conservation of continuous liquid momentum:
\begin{IEEEeqnarray}{rcl}
\dx{} ( \dot{m}_{l}^{n+1} & - & \dot{m}_{l}^{n} ) = - \dt{} \sum_{NK} \left( <\alpha_l \rho_l u_l>^n_d u^n_l \cdot \vec{\bar{A}}\right) \nonumber \\
 & + & \dt{} V_m\left[ (\alpha_l \rho_l)^{n} g  - \alpha^{n}_l \nabla P^{n+1} - K^{n}_{wl}(\dot{m}_l^{n+1})^2 \right. \nonumber \\
 & + & \left. K^{n}_{i,gl}(\dot{m}^{n+1}_l - \dot{m}_g^{n+1})^2\right] - \dt{}\left[((1 - \eta)\Gamma u^{'})^{n} - (S u^{'})^{n}\right] \nonumber
\end{IEEEeqnarray}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Semi-Implicit Method Solver}

Example: 3 continuity volumes and 3 momentum volumes.

\begin{equation*}
\label{eqn:si_solve}
\begin{bmatrix} 
\vec{J}_{m_1} & \vec{J}_{m_1,c_1} & \vec{0} & \vec{0} & \vec{0} & \vec{0}\\
\vec{J}_{c_1,m_1} & \vec{J}_{c_1} & \vec{J}_{c_1,m_2} & \vec{0} & \vec{0} & \vec{0} \\
\vec{0} & \vec{J}_{m_2,c_1} & \vec{J}_{m_2} & \vec{J}_{m_2,c_2} & \vec{0} & \vec{0} \\
\vec{0} & \vec{0} & \vec{J}_{c_2,m_2} & \vec{J}_{c_2} & \vec{J}_{c_2,m_3} & \vec{0} \\
\vec{0} & \vec{0} & \vec{0} & \vec{J}_{m_3,c_2} & \vec{J}_{m_3} & \vec{J}_{m_3,c_3} \\ 
\vec{0} & \vec{0} & \vec{0} & \vec{0} & \vec{J}_{c_3,m_3} & \vec{J}_{c_3}  
\end{bmatrix} \begin{bmatrix}
\vec{\delta m}_{1} \\ \vec{\delta c}_{1} \\
\vec{\delta m}_{2} \\ \vec{\delta c}_{2} \\
\vec{\delta m}_{3} \\ \vec{\delta c}_{3}
\end{bmatrix}  = -\begin{bmatrix}
\vec{F}_{m_1} \\ \vec{F}_{c_1} \\
\vec{F}_{m_2} \\ \vec{F}_{c_2} \\
\vec{F}_{m_3} \\ \vec{F}_{c_3} \end{bmatrix}
\end{equation*}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Semi-Implicit Method Solver}

\begin{equation*}
\label{eqn:si_solve_3}
\begin{bmatrix} 
\vec{J}^{*}_{c_1} & \vec{C}_{c_1,P_2} & \vec{0} \\
\vec{C}_{c_2,P_1} & \vec{J}^{*}_{c_2} & \vec{C}_{c_2,P_3} \\
\vec{0}           & \vec{C}_{c_3,P_2} & \vec{J}^{*}_{c_3}
\end{bmatrix} \begin{bmatrix}
\vec{\delta c}_{1} \\
\vec{\delta c}_{2} \\
\vec{\delta c}_{3}
\end{bmatrix}  = -\begin{bmatrix}
\vec{F}^{*}_{c_1} \\
\vec{F}^{*}_{c_2} \\
\vec{F}^{*}_{c_3}
\end{bmatrix}
\end{equation*}
 
\end{frame}
%------------------------------------------------------------------------------
%------------------------------------------------------------------------------
\subsection[Algorithmic Concerns]{Algorithmic Concerns}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Phase Transition}

\begin{itemize}
\item{Does not switch to single-phase flow conservation equations.}
\item{Minimum volume fraction for each water phase is enforced: $\alpha_{k,\text{MIN}}$ = 1.0E-9.}
\item{The two liquid water fields split the minimum presence equally.}
\item{Velocity equilibrium of fields during psuedo single-phase flow is enforced through an artificial interfacial drag.}
\item{The \ncg{} field, through its partial pressure $P_n$, is allowed to go zero.}
\end{itemize}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Timestep Failure Mitigation and Size Selection}

\begin{itemize}
\item{Change of phasic enthalpy cannot be greater than 45 [$\frac{\text{BTU}}{\lbm{}}$].}
\item{Change in pressure cannot be greater than 20 [psia].}
\item{Change in partial pressure of the \ncg{} field cannot be greater than 20 [psia].}
\item{Thermodynamic variables would fall outside of the range of validity of the equations of state.}
\end{itemize}

\begin{equation*}
\label{eqn:time_step}
\Delta t^{n} = \max\left[ \Delta t_{\text{MIN}}, \min\left[1.2 \Delta t^{n-1}, 0.85 \Delta t_{\text{CRNT}}, \Delta t_{\text{MAX}} \right]\right]
\end{equation*}

\end{frame}
%------------------------------------------------------------------------------
%------------------------------------------------------------------------------
\subsection[Domain Coupling]{Domain Coupling}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Code Coupling}

\begin{figure}[h!t]
\centering
\includegraphics[width=.94\textwidth]{images/coupled_domains.eps}
\end{figure}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{RELAP5-3D Semi-Implicit Coupling}

\begin{IEEEeqnarray}{rcl}
\label{eqn:si_relap}
\delta P^{n+1}_{k} = a_k & + & 
\sum_{j = 1}^{N_c} \left[ b_{k,j}n_{g,j}^{n+1} + c_{k,j}u_{g,j}^{n+1} + d_{k,j}u_{f,j}^{n+1} + e_{k,j}m_{g,j}^{n+1} \right. \nonumber \\
& + & \left. f_{k,j}m_{f,j}^{n+1} + g_{k,j}w_{g,j}^{n+1} +h_{k,j}w_{f,j}^{n+1} \right] \nonumber
\end{IEEEeqnarray}

\begin{IEEEeqnarray}{rcl}
\label{eqn:pressure_coupled}
\delta P^{n+1}_{\text{cbv}} = a_{\text{cbv}} & + & 
\sum_{j = 1}^{N_c} A_j \left[ b_{\text{cbv},j}<\alpha^n_g \rho^n_n>^{n}_{d} v_{g,j}^{n+1} \right. \nonumber \\
& + & c_{\text{cbv},j}<\alpha_g^n \rho_g^n u^n_g>_d^n v_{g,j}^{n+1} +
d_{\text{cbv},j} <\alpha_f^n \rho_f^n u_f^n>_d^n v_{f,j}^{n+1}  \nonumber \\
& + & e_{\text{cbv},j} <\alpha_g^n \rho_g^n>_d^n v_{g,j}^{n+1} +
f_{\text{cbv},j} < \alpha_f^n \rho_f^n>_d^n v_{f,j}^{n+1} \nonumber \\
& + & \left. g_{\text{cbv},j} <\alpha^n_g>_d^n v_{g,j}^{n+1} +
h_{\text{cbv},j} <\alpha_f^n>_d^n v_{f,j}^{n+1} \right] \nonumber
\end{IEEEeqnarray}

\end{frame}
%------------------------------------------------------------------------------
%------------------------------------------------------------------------------
\subsection[Research Objectives]{Research Objectives}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Research Objectives}

\begin{itemize}
\item{Develop, implement, and test a domain decomposition method based upon RELAP5-3D semi-implicit code coupling.}
\item{Quantification of nonlinearities within subdomain.}
\item{Resolution of nonlinearities within a subdomain using consistent boundary values.}
\item{Develop and test metric for possible nonlinear nonconvergence of a time-step size insensitive solution.}
\end{itemize}

\end{frame}
%------------------------------------------------------------------------------
%------------------------------------------------------------------------------
\section[Preliminary Work]{Preliminary Work}
%------------------------------------------------
%------------------------------------------------
\subsection[COBRA]{Nonlinear COBRA}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Nonlinear COBRA}

\begin{itemize}
\item{Original source code assumes that $\vec{x}^{n+1,k} = \vec{x}^{n}$.
    \begin{itemize}
    \item{Temporal derivative terms missing from continuity residuals.}
    \item{Use of $\vec{x}^{n+1,k}$ for $\vec{x}^{n}$.}
    \item{Use of $\vec{x}^{n}$ for $\vec{x}^{n+1,k}$.}
    \item{Drag terms reformulated.}
    \end{itemize}
}
\item{Linesearch algorithm with cubic backtracking.}
\item{Quality assurance framework.}
\end{itemize}

\end{frame}
%------------------------------------------------------------------------------
%------------------------------------------------------------------------------
\subsection[Scaling]{Operator Based Scaling}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Operator-Based Scaling}
Nonlinear residuals have different units:

\begin{IEEEeqnarray}{rcl}
F_{m,l} & = & V_c \left[ \left(\alpha_l \rho_l \right)^{n+1} - \left(\alpha_l \rho_l \right)^{n} \right] + \dt{} \sum_{NK}\left( <\alpha^n_l \rho^n_l>^{n}_{d} u^{n+1}_l  \cdot \vec{\bar{A}}\right) \nonumber \\
& + & \dt{} \left[(1-\eta)\Gamma + S \right]^{n+1} \nonumber
\end{IEEEeqnarray}

Scaling chosen:

\begin{IEEEeqnarray}{rcl}
S_{m,l} & = & V_c \abs{\left(\alpha_l \rho_l \right)^{n+1} - \left(\alpha_l \rho_l \right)^{n}} + \dt{} \sum_{NK}\abs{\left( <\alpha^n_l \rho^n_l>^{n}_{d} u^{n+1}_l  \cdot \vec{\bar{A}}\right)} \nonumber \\
& + & \dt{} \left[\abs{(1-\eta)\Gamma} + \abs{S} \right]^{n+1}
\end{IEEEeqnarray}


\end{frame}
%------------------------------------------------------------------------------
%------------------------------------------------------------------------------
\subsection[Convergence]{Temporal Convergence}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Temporal Convergence vs Timestep Size Insensitivity}

\begin{itemize}
\item{Timestep size insensitivity: solution is insensitive to reduction of \dtmax{}.}
\item{Temporal convergence: error due to numerical approximation of temporal integral below engineering scales of interest.}
\end{itemize}
Metrics for nonlinear convergence testing:
\begin{equation*}
\tilde{R} = \frac{\int_{t^{0}}^{t^{N}} ||\vec{F}(\tau)||_2 \,\mathrm{d} \tau}{t^{N} - t^{0}}
\end{equation*}
\begin{equation*}
\tilde{R}_{\text{M}} = \frac{\int_{t^{0}}^{t^{N}} \,\tau\,||\vec{F}(\tau)||_2 \,\mathrm{d} \tau}{\int_{t^{0}}^{t^{N}} \,\tau \,\mathrm{d} \tau}
\end{equation*}

\end{frame}
%------------------------------------------------------------------------------
%------------------------------------------------------------------------------
\subsection[Experiments]{Numerical Experiments}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Numerical Experiments: Purpose}

\begin{itemize}
\item{Test nonlinear solver framework.}
\item{Determine the impact of nonlinear convergence upon timestep size insensitivity.}
\item{Determine the efficacy of nonlinear convergence metric in predicting timestep size insensitivity.}
\end{itemize}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Numerical Experiments: Geometry}
\begin{columns}
\column{0.7\textwidth}

\begin{itemize}
\item{Cross-sectional area: 4 [in$^2$]}
\item{Total height: 48 [in]}
\item{\dx{} is constant: 4 [in]}
\item{ Boundary Conditions
	\begin{itemize}
	\item{Specified inlet flow-enthalpy}
	\item{Specified outlet pressure-enthalpy}
\end{itemize}
}
\end{itemize}

\column{0.3\textwidth}
\begin{figure}[h!t]
\centering
\resizebox{!}{0.7\textheight}{
\begin{tikzpicture}
\foreach \x in {1,..., 12} \draw(0, 0.5*\x-0.5) rectangle +(.5,.5);
\filldraw[fill=red] (0, 6) rectangle +(.5,.5); 
\filldraw[fill=red] (0, -0.5) -- (0.25, 0) -- (0.5, -0.5) -- cycle;
\draw[->] (2,0) -- (2, 1) node[anchor=west] {z};
\draw[->] (2,0) -- (3, 0) node[anchor=west] {$\perp$ z};
\end{tikzpicture}
}
\end{figure}
\end{columns}
\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Numerical Experiments: Initial Conditions}

\begin{table}[ht]
\centering
\begin{tabular}{@{}lr@{.}lr@{.}lr@{.}lr@{.}lr@{.}l@{}} \toprule
\multirow{2}{*}{Problem} & \multicolumn{2}{c}{Pressure} & \multicolumn{2}{c}{Enthalpy}             & \multicolumn{2}{c}{$\alpha_g$} & \multicolumn{2}{c}{$\alpha_l$} & \multicolumn{2}{c}{$\alpha_e$} \\ 
                         & \multicolumn{2}{c}{[psia]} & \multicolumn{2}{c}{$[\frac{\text{Btu}}{\lbm{}}]$} & \multicolumn{2}{c}{[-]}      & \multicolumn{2}{c}{[-]}      & \multicolumn{2}{c}{[-]}      \\ \midrule
Single-Phase & 200&0  &  355&5 & 0&0 & 1&0 & 0&0 \\
Flashing     & 200&0  & 1198&3 & 1&0 & 0&0 & 0&0 \\ \bottomrule  
\end{tabular}
\label{tab:ic}
\end{table}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Numerical Experiments: Outlet Boundary Conditions}

\begin{table}[ht]
\centering
\begin{tabular}{@{}lr@{.}lr@{.}lr@{.}lr@{.}lr@{.}l@{}} \toprule
\multirow{2}{*}{Problem} & \multicolumn{2}{c}{Pressure} & \multicolumn{2}{c}{Enthalpy}             & \multicolumn{2}{c}{$\alpha_g$} & \multicolumn{2}{c}{$\alpha_l$} & \multicolumn{2}{c}{$\alpha_e$} \\ 
                         & \multicolumn{2}{c}{[psia]} & \multicolumn{2}{c}{$[\frac{\text{BTU}}{\lbm{}}]$} & \multicolumn{2}{c}{[-]}      & \multicolumn{2}{c}{[-]}      & \multicolumn{2}{c}{[-]}      \\ \midrule
Single-Phase & 200&0 &  355&5 & 0&0 & 1&0 & 0&0 \\
Flashing     & 200&0 & 1198&3 & 1&0 & 0&0 & 0&0 \\ \bottomrule  
\end{tabular}
\label{tab:bc_pe}
\end{table}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Numerical Experiments: Inlet Boundary Conditions}

\begin{table}[ht]
\centering
\begin{tabular}{@{}lr@{.}lr@{.}lr@{.}lr@{.}lr@{.}l@{}} \toprule
\multirow{2}{*}{Problem} & \multicolumn{2}{c}{Pressure} & \multicolumn{2}{c}{Enthalpy}             & \multicolumn{2}{c}{$\alpha_g$} & \multicolumn{2}{c}{$\alpha_l$} & \multicolumn{2}{c}{$\alpha_e$} \\ 
                         & \multicolumn{2}{c}{[psia]} & \multicolumn{2}{c}{$[\frac{\text{BTU}}{\lbm{}}]$} & \multicolumn{2}{c}{[-]}      & \multicolumn{2}{c}{[-]}      & \multicolumn{2}{c}{[-]}      \\ \midrule
Single-Phase &  200&0 & 355&5 & 0&0 & 1&0 & 0&0 \\
Flashing     & 1000&0 & 542&6 & 1&0 & 0&0 & 0&0 \\ \bottomrule  
\end{tabular}
\label{tab:bc_fe}
\end{table}

\begin{equation*}
\label{eqn:bc_time_func_single}
\dot{m}(t) = \left\{
\begin{array}{cclrcll}
 0.0           & [\frac{ \lbm{} }{\text{s}}] & , &                & t & \leq 1 & [\text{s}] \\
 0.5 ( t - 1)  & [\frac{ \lbm{} }{\text{s}}] & , & 1\; [\text{s}] < & t & \leq 2 & [\text{s}] \\
 0.5           & [\frac{ \lbm{} }{\text{s}}] & , &                & t & > 2    & [\text{s}]
\end{array}\right.
\end{equation*}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Numerical Experiments: Procedure}

\begin{itemize}
\item{Two simulations are run at sequentially smaller \dtmax{}:
\begin{itemize}
\item{\dtmax{} = 1.0 [s], 1.0E-1 [s], ..., 1.0E-5 [s]}
\end{itemize}
}
\item{Parameters of interest:
\begin{itemize}
\item{Flashing problem: $\alpha_g$ @ 2 [in] from inlet.}
\item{Single-phase problem: $\dot{m}_l$ @ 4 [in] from inlet.}
\end{itemize}
}
\item{Comparison of convergence metrics:
\begin{itemize}
\item{$\tilde{R}$}
\item{$\tilde{R}_{\text{M}}$}
\end{itemize}
}
\end{itemize}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Flashing solution at \dtmax{} = 1.0E-1 {[s]}}

\begin{figure}[h!t]
\centering
\includegraphics[width=0.94\textwidth]{images/flashing_1em1.eps}
\end{figure}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Flashing solution at \dtmax{} = 1.0E-5 {[s]}}

\begin{figure}[h!t]
\centering
\includegraphics[width=.94\textwidth]{images/flashing_1em5.eps}
\end{figure}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Legacy solver flashing solution}

\begin{figure}[h!t]
\centering
\includegraphics[width=.94\textwidth]{images/cobra_flashing_al_2in.eps}
\end{figure}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Nonlinear solver flashing solution}

\begin{figure}[h!t]
\centering
\includegraphics[width=.94\textwidth]{images/nl_flashing_al_2in.eps}
\end{figure}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Nonlinear solver timestep size insensitive flashing solution}

\begin{figure}[h!t]
\centering
\includegraphics[width=.94\textwidth]{images/nl_flashing_1em0_1em1.eps}
\end{figure}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Legacy solver timestep size insensitive flashing solution}

\begin{figure}[h!t]
\centering
\includegraphics[width=.94\textwidth]{images/cobra_flashing_1em1_1em4.eps}
\end{figure}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Residual of the flashing solution for the legacy solver}

\begin{figure}[h!t]
\centering
\includegraphics[width=0.94\textwidth]{images/cobra_flashing_res_compare.eps}
\end{figure}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Residual of the flashing solution for the nonlinear solver}

\begin{figure}[h!t]
\centering
\includegraphics[width=0.94\textwidth]{images/nl_flashing_res_compare.eps}
\end{figure}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Single-phase solution with \dtmax{} = 1.0 {[s]}}

\begin{figure}[h!t]
\centering
\includegraphics[width=0.94\textwidth]{images/single_1em0.eps}
\end{figure}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Single-phase solution with \dtmax{} = 1.0E-5 {[s]}}

\begin{figure}[h!t]
\centering
\includegraphics[width=0.94\textwidth]{images/single_1em5.eps}
\end{figure}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Legacy solver single-phase residuals}

\begin{figure}[h!t]
\centering
\includegraphics[width=0.94\textwidth]{images/cobra_single_res_v_dt.eps}
\end{figure}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Nonlinear solver single-phase residuals}

\begin{figure}[h!t]
\centering
\includegraphics[width=0.94\textwidth]{images/nl_single_res_v_dt.eps}
\end{figure}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Zoomed nonlinear solver single-phase residuals}

\begin{figure}[h!t]
\centering
\includegraphics[width=0.94\textwidth]{images/nl_res_single_zoom.eps}
\end{figure}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Single-phase solution with \dtmax{} = 1.0E-3 {[s]}}

\begin{figure}[h!t]
\centering
\includegraphics[width=0.94\textwidth]{images/single_1em3.eps}
\end{figure}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Zoomed single-phase solution with \dtmax{} = 1.0E-3 {[s]}}

\begin{figure}[h!t]
\centering
\includegraphics[width=0.94\textwidth]{images/single_1em3_zoom.eps}
\end{figure}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Convergence Metrics for Flashing Problem}

\begin{table}[h!t]
\centering
\resizebox{0.9\textwidth}{!}{
\begin{tabular}{@{}l r@{.}l r@{.}l r@{.}l r@{.}l @{}}
\toprule
& \multicolumn{4}{c}{$\tilde{R}$} & \multicolumn{4}{c}{$\tilde{R}_{\text{M}}$}  \\
$\dtmax{}$ & \multicolumn{2}{c}{Legacy} & \multicolumn{2}{c}{Nonlinear} & \multicolumn{2}{c}{Legacy}& \multicolumn{2}{c}{Nonlinear}  \\
\midrule
1.0    & \multicolumn{2}{c}{-} & 1&177E-3 & \multicolumn{2}{c}{-} & 6&885E-4 \\
1.0E-1 & 5&487E-2 & 1&141E-3 & 5&044E-2 & 6&730E-4 \\
1.0E-2 & 4&960E-2 & 3&413E-4 & 4&570E-2 & 2&511E-4 \\
1.0E-3 & 3&172E-2 & 2&669E-4 & 2&372E-2 & 1&975E-4 \\
1.0E-4 & 2&504E-2 & 1&346E-4 & 1&838E-2 & 8&974E-5 \\
1.0E-5 & 2&166E-2 & 5&075E-5 & 1&922E-2 & 4&581E-5 \\
\bottomrule  
\end{tabular}
}
\end{table}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Convergence Metrics for Single-Phase Problem}

\begin{table}[h!t]
\centering
\resizebox{0.9\textwidth}{!}{
\begin{tabular}{@{}l r@{.}l r@{.}l r@{.}l r@{.}l @{}}
\toprule
& \multicolumn{4}{c}{$\tilde{R}$} & \multicolumn{4}{c}{$\tilde{R}_{\text{M}}$}  \\
$\dtmax{}$ & \multicolumn{2}{c}{Legacy} & \multicolumn{2}{c}{Nonlinear} & \multicolumn{2}{c}{Legacy}& \multicolumn{2}{c}{Nonlinear}  \\
\midrule
1.0    & 3&149E-3 & 1&700E-3 & 1&485E-3 & 1&070E-4 \\
1.0E-1 & 2&866E-3 & 1&700E-3 & 1&287E-3 & 1&070E-4 \\
1.0E-2 & 3&412E-4 & 1&357E-3 & 1&417E-4 & 7&701E-5 \\
1.0E-3 & 2&207E-4 & 4&584E-4 & 8&805E-5 & 1&178E-4 \\
1.0E-4 & 1&672E-4 & 1&588E-3 & 1&834E-5 & 4&958E-5 \\
1.0E-5 & 5&493E-4 & 2&758E-4 & 1&916E-5 & 8&939E-5 \\
\bottomrule  
\end{tabular}
}
\end{table}

\end{frame}
%------------------------------------------------------------------------------
%------------------------------------------------------------------------------
\subsection[Review]{Review}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Preliminary Work Review}

\begin{itemize}
\item{Methods that resolve nonlinearities during a timestep allows for a timestep size insensitive solution at larger \dtmax{} than methods that do not.}
\item{A timestep size insensitive solution produced by a linearized approximation may be different than one produced by a nonlinearly convergent solver.}
\item{Both solvers produce similar solutions in simple problems.} 
\end{itemize}

\end{frame}
%------------------------------------------------------------------------------
%------------------------------------------------------------------------------
\section[Proposed Work]{Proposed Work}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Proposed Timeline}


\newcommand{\cc}{\cellcolor{black}}
\begin{table}
\centering
\resizebox{0.9\textwidth}{!}{
\begin{tabular}{@{}l l c c c c  c c c c c c @{}} \toprule
Task & \multicolumn{1}{r}{Month} & Jan & Feb & Mar & Apr & May & Jun & Jul & Aug & Sep & Oct\\
\midrule
\multicolumn{12}{l}{Scaling}  \\
& Implementation & \cc & \cc &     &     &     &     &     &     &     &     \\
& Testing        &     & \cc & \cc &     &     &     &     &     &     &     \\
\multicolumn{12}{l}{Domain Decomposition} \\
& Development    & \cc & \cc &     &     &     &     &     &     &     &     \\
& Implementation &     & \cc & \cc & \cc & \cc &     &     &     &     &     \\
& Testing        &     &     &     &     & \cc & \cc &     &     &     &     \\
\multicolumn{12}{l}{Temporal Convergence Criteria}\\
& Implementation & \cc & \cc &     &     &     &     &     &     &     &     \\
& Testing        &     &     & \cc & \cc &     &     &     &     &     &     \\
\multicolumn{12}{l}{Performance Evaluation} \\
& Testing        &     &     &     &     &     & \cc & \cc &     &     &     \\
\multicolumn{12}{l}{Parametric Studies} \\
& Testing        &     &     &     &     &     & \cc & \cc & \cc &     &     \\
\multicolumn{12}{l}{Dissertation} \\
& Writing        & \cc & \cc & \cc & \cc & \cc & \cc & \cc & \cc & \cc & \cc \\
\bottomrule  
\end{tabular}
}
\end{table}

\end{frame}
%------------------------------------------------------------------------------
%------------------------------------------------------------------------------
\subsection[Scaling]{Scaling Work}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Proposed Scaling Work}

Issues that need to be addressed in scaling:
\begin{itemize}
\item{Nontrivial values of the residual during steady-state portion of transients.}
\item{Nonconvergence of nonlinear solver.}
\item{Inconsistent scaling of the update vector in the Newton loop and the linesearch algorithm.} 
\end{itemize}

\end{frame}
%------------------------------------------------------------------------------
%------------------------------------------------------------------------------
\subsection[Domain Decomposition]{Domain Decomposition}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Proposed Domains Decomposition Work}

Milestones required for implementation of domain decomposition:

\begin{itemize}
\item{Generation of mathematical formulation for COBRA-COBRA semi-implicit domain decomposition.}
\item{Implementation of decomposition logic into COBRA software.}
\item{Development of problems with geometric complexity.}
\item{Test legacy solver using domain decomposition logic.} 
\end{itemize}

\end{frame}
%------------------------------------------------------------------------------
%------------------------------------------------------------------------------
\subsection[Testing]{Proposed Testing}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Proposed Testing}

\begin{itemize}
\item{I need to test convergence tolerances of the newton-loop.}
\item{I need to test metric values to determine when a solution is "good enough."}
\end{itemize}

\end{frame}
%------------------------------------------------------------------------------
%------------------------------------------------------------------------------
\subsection[Possible Outcomes]{Possible Outcomes}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Possible Outcomes}

\begin{itemize}
\item{Demonstrate that not resolving the nonlinearities within a timestep reduces the temporal convergence of the solution.}
\item{Develop a domain decomposition method to enable local nonlinearities to be resolved.}
\item{By resolving local nonlinearities, a timestep size insensitive solution may be obtained at larger timesteps than otherwise achievable.}
\end{itemize}

\end{frame}
%------------------------------------------------------------------------------
%------------------------------------------------------------------------------
\section*{}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Acknowledgments}

This research was performed under appointment to the Rickover Fellowship Program in Nuclear Engineering sponsored by Naval Reactors Division of the U.S. Department of Energy.

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Conservation of Mass}

\begin{IEEEeqnarray}{rCl}
\label{eqn:conservation_of_ncg}
\frac{\partial \left(\alpha_g \rho_{n}\right) }{\partial t } + \nabla \cdot \left( \alpha_g \rho_{n} \vec{u}_g \right) & = & s_{m,n} \nonumber \\
\label{eqn:conservation_of_vap}
\frac{\partial \left(\alpha_g \rho_v \right)}{\partial t } + \nabla \cdot \left( \alpha_g \rho_v \vec{u}_g \right)         & = & \Gamma^{'''} + s_{m,v} \nonumber \\
\label{eqn:conservation_of_liq}
\frac{\partial \left(\alpha_l \rho_l \right)}{\partial t } + \nabla \cdot \left( \alpha_l \rho_l \vec{u}_l \right)         & = & -(1-\eta)\Gamma^{'''} - S^{'''} + s_{m,l} \nonumber \\
\label{eqn:conservation_of_ent}
\frac{\partial \left(\alpha_e \rho_l \right)}{\partial t } + \nabla \cdot \left( \alpha_e \rho_l \vec{u}_e \right)         & = & -\eta\Gamma^{'''} + S^{'''}+ s_{m,e} \nonumber
\end{IEEEeqnarray}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Conservation of Momentum}

\begin{IEEEeqnarray}{rCl}
\label{eqn:con_mom_liq}
\frac{\partial \left( \alpha_l \rho_l \vec{u}_l \right )}{\partial t } + \nabla \cdot \left( \alpha_l \rho_l \vec{u}_l \vec{u}_l \right) & = & \nonumber \\
 -\alpha_l \nabla P + \alpha_l \rho_l \vec{g} - \vec{\tau}^{'}_{w,l} + \vec{\tau}^{'}_{i,gl} - (1 - \eta)\Gamma^{'''}\vec{u}^{'} - S^{'''}\vec{u}^{'} + s_{p,l} & & \nonumber \\
\label{eqn:con_mom_gas}
\frac{\partial \left( \alpha_g \rho_g \vec{u}_g \right) }{\partial t } + \nabla \cdot \left( \alpha_g \rho_g \vec{u}_g \vec{u}_g \right) & = & \nonumber \\
 -\alpha_g \nabla P + \alpha_g \rho_g \vec{g} - \vec{\tau}^{'}_{w,g} - \vec{\tau}^{'}_{i,gl} - \vec{\tau}^{'}_{i,ge} + \Gamma^{'''}\vec{u}^{'} + s_{p,g} & & \nonumber \\
\label{eqn:con_mom_ent}
\frac{\partial \left( \alpha_e \rho_l \vec{u}_e \right) }{\partial t } + \nabla \cdot \left( \alpha_e \rho_l \vec{u}_e \vec{u}_e \right) & = & \nonumber \\
 -\alpha_e \nabla P + \alpha_e \rho_l \vec{g} - \vec{\tau}^{'}_{w,l} + \vec{\tau}^{'}_{i,ge} - \eta \Gamma^{'''}\vec{u}^{'} + S^{'''}\vec{u}^{'} + s_{p,l} & & \nonumber
\end{IEEEeqnarray}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Conservation of Energy}

\begin{IEEEeqnarray}{rCl}
\label{eqn:con_energy_gas}
\frac{\partial \left( \alpha_g \{\rho_g h_g\} \right)}{\partial t } + \nabla \cdot \left(  \alpha_g \{\rho_g h_g\} \vec{u}_g \right) & =& \nonumber \\
\Gamma^{'''} h^{'}_v + q^{'''}_{i,v} + q^{'''}_{n,l}  + q^{'''}_{w,g} + \alpha_g\frac{\partial P}{\partial t} + s_{e,g}  & & \nonumber \\
\label{eqn:con_energy_liq}
\frac{\partial \left( (1 - \alpha_g) \rho_l h_l \right) }{\partial t } + \nabla \cdot \left( \alpha_l \rho_l h_l \vec{u}_l \right) + \nabla \cdot \left( \alpha_e \rho_l h_l \vec{u}_e \right)& = & \nonumber \\
-\Gamma^{'''} h^{'}_l +  q^{'''}_{i,l} - q^{'''}_{n,l}  + q^{'''}_{w,l} + (1 - \alpha_g) \frac{\partial P}{\partial t} + s_{e,l}  & & \nonumber
\end{IEEEeqnarray}

\begin{equation*}
\label{eqn:gaseous_enthalpy}
\alpha_g \{\rho_g h_g\} = \alpha_g \rho_v h_v + \alpha_g \rho_n h_n
\end{equation*}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Fully Explicit Method}
Residual: $\vec{F}(\vec{x}^{n+1}) = \vec{y}(\vec{x}^{n+1}) - \vec{y}^{n} - \dt{} \vec{E}(\vec{x}^{n})$.
\begin{columns}
\column{0.45\textwidth}
\begin{itemize}
\item{Lowest per timestep computational cost.}
\item{Nonlinearities in the new-time conserved quantities.}
\item{Sonic Courant limit: $ \Delta t \lesssim \frac{\Delta x}{|u|+|c|}$}
\end{itemize}

\column{0.55\textwidth}
\begin{algorithmic}
\scriptsize
\Require $\vec{x}^{0}$ and $t^{0}$
\Set $n = 0$
\Loop \; Take a Time Step
    \Set $t^{n+1} : = t^{n} + \Delta t$
    \Calculate $\vec{F}(\vec{x}^n)$ and $\vec{J}(\vec{x}^n)$
    \Calculate $\vec{\delta x} = -\vec{J}^{-1}\vec{F}$
    \Calculate $\vec{x}^{n+1} = \vec{x}^{n} + \vec{\delta x}$ 
\EndLoop{\;$n = n+1$}
\end{algorithmic}

\end{columns}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Fully Implicit Method}

Residual: $\vec{F}(\vec{x}^{n+1}) = \vec{y}(\vec{x}^{n+1}) - \vec{y}^{n} - \dt{} \vec{E}(\vec{x}^{n+1})$.

\begin{columns}
\column{0.45\textwidth}

\begin{itemize}
\item{Highest per timestep computational cost.}
\item{Nonlinearities in $\vec{E}(\vec{x}^{*})$.}
\item{No Courant limit.}
\item{CATHARE}
\end{itemize}

\column{0.55\textwidth}

\begin{algorithmic}
\scriptsize
\Require $\vec{x}^{0}$ and $t^{0}$
\Set $n = 0$
\Loop \; Transient Loop
    \Set $t^{n+1} : = t^{n} + \Delta t$
    \Set $k = 0$
    \Set $\vec{x}^{k} = \vec{x}^{n}$
    \Loop \; Newton Loop
		\Calculate $\vec{F}(\vec{x}^{k})$ and $\vec{J}(\vec{x}^{k})$
		\Calculate $\vec{\delta x}^k = - \vec{J}^{-1}\cdot\vec{F}$
		\BlackBox Calculate $\vec{x}^{k+1}$
		\BlackBox Terminate Loop
	\EndLoop{\;$k = k + 1$} 	
\EndLoop{\;$n = n + 1$}
\end{algorithmic}

\end{columns}
\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Stability-Enhancing Two-Step Method}

\begin{columns}
\column{0.45\textwidth}

\begin{itemize}
\item{Developed to overcome material Courant limit of the semi-implicit method.}
\item{Multistage approximation to $\vec{E}(\vec{x}^{*})$.}
\item{Courant limit above the material Courant limit but not unbounded.}
\item{TRACE}
\end{itemize}

\column{0.5\textwidth}
\begin{algorithmic}
\scriptsize
\Require $\vec{x}^{0}$ and $t^{0}$
\Set $n = 0$
\Loop \; Transient Loop
    \State $t^{n+1} : = t^{n} + \Delta t$
	\Calculate $\vec{F}_1$ and $\vec{J}_1$
	\Calculate $\vec{u}^{*}$ from $\vec{\delta u}^{*} = -\vec{J}^{-1}_1\vec{F}_1$
	\Loop \; Newton Loop
		\Calculate $\vec{F}_2$ and $\vec{J}_2$
		\Calculate $\vec{\delta x} = - \vec{J}_2^{-1}\vec{F}_2$
		\Calculate $\vec{x}^{n+1} = \vec{x}^{n} + \vec{\delta x}$
	\EndLoop
	\Calculate $\vec{x}^{n+1}$ from $\vec{F}_3$.
\EndLoop{\; $n = n + 1$} 
\end{algorithmic}

\end{columns}
\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Nearly-Implicit Method}

\begin{columns}
\column{0.45\textwidth}

\begin{itemize}
\item{Derivative of SETS method.}
\item{Developed to overcome material Courant limit of the semi-implicit method.}
\item{Three-stage approximation to $\vec{E}(\vec{x}^{*})$.}
\item{Courant limit above the material Courant limit but not unbounded.}
\item{Two-stage variant used in RELAP5-3D}
\end{itemize}

\column{0.5\textwidth}
\begin{algorithmic}
\scriptsize
\Require $\vec{x}^{0}$ and $t^{0}$
\Set $n = 0$
\Loop \; Transient Loop
    \State $t^{n+1} : = t^{n} + \Delta t$
	\Calculate $\vec{F}_1$ and $\vec{J}_1$
	\Calculate $\vec{\delta x}^{*} = -\vec{J}^{-1}_1\vec{F}_1$
	\Calculate $\vec{c}^{*}$ and $\vec{u}^{n+1}$
	\Calculate $\vec{F}_2$
	\Calculate $\vec{c}^{**}$ from $\vec{F}_2$
	\Calculate $\vec{c}^{n+1}$ from $\vec{F}_3$.
\EndLoop{\; $n = n + 1$}
\end{algorithmic}

\end{columns}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Legacy flashing residual}

\begin{figure}[h!t]
\centering
\includegraphics[width=0.94\textwidth]{images/flashing_semilogy_res_compare_lin.eps}
\end{figure}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Nonlinear flashing residual}

\begin{figure}[h!t]
\centering
\includegraphics[width=0.94\textwidth]{images/flashing_semilogy_res_compare_nl.eps}
\end{figure}
\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Legacy single-phase residual}

\begin{figure}[h!t]
\centering
\includegraphics[width=0.94\textwidth]{images/single_semilogy_res_v_dt_lin.eps}
\end{figure}

\end{frame}
%------------------------------------------------
%------------------------------------------------
\begin{frame}
\frametitle{Nonlinear single-phase residual}

\begin{figure}[h!t]
\centering
\includegraphics[width=0.94\textwidth]{images/single_semilogy_res_v_dt_nl.eps}
\end{figure}
\end{frame}
%------------------------------------------------------------------------------
%------------------------------------------------------------------------------
\end{document}