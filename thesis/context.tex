\chapter{Introduction}
\label{chap:intro}
In the United States, the goal of Nuclear Power Plant (NPP) designers, builders, operators, and regulators is to ensure the safety of the public during both normal operations and during severe accidents.
It is the responsibility of the Nuclear Regulatory Commission to issue licenses for the construction and operation of nuclear reactors.
Chapter 1 of Title 10 of the Code of Federal Regulations (10CFR) details the process by which an applicant can obtain an operating licesce for the construction of a NPP.
One of the requirements laid out in Part 50 of 10CFR (10CFR50) is the requirement for a safety analysis report (SAR).
Depending upon the license being pursued by the applicant, either a Preliminary Safety Analysis Report (PSAR) or a Final Safety Analysis Report (FSAR).
The PSAR is required for the issuance of a site construction license, while the FSAR is required for the issuance of either an operating license or a combined license.
For reactors that use light water, $H_2 O$, as a primary coolant, Light Water Reactors (LWR), both types of SARs require that the applicant provide information an evaluation of their Emergency Core Cooling System (ECCS) during postulated loss-of-coolant accidents (LOCA).
This evaluation must conform with section 46 of 10CFR50, which requires that the applicant perform analyses for "a number of postulated loss-of-coolant accidents of different sizes, locations, and other properties sufficient to provide assurance that the most severe postulated loss-of-coolant accidents are calculated."
This requirement necessitates that the designers and operators of NPP possess the ability to model the thermal-hydraulic behavior within the core of a reactor during severe accidents.  
The diverse physical conditions experienced by the reactor during severe accidents necessitates the inclusion of a wide array of physics during safety analyses.
Among the physics of interest are fluid-mechanics, neutron transport, structural mechanics, and radio-chemistry.
For each of these disciplines there are dedicated pieces of software under continual development to improve their predictive capabilities.
The work that follows is concerned with the mathematical formulation and solution of the equations governing the thermal-hydraulic behavior of the reactor core.

All operating commercial reactors within the United States are of a light water reactor (LWR) design.
There are two types of LWR designs within the US, pressurized water reactors (PWRs) and boiling water reactors (BWRs).
In both cases, the safety analysis requires the modeling of water as both a fluid and as a gas.
This fact has driven the development of safety software that can model the behavior of water under a extensive range of thermodynamic states, including multiple-phases.
There are several formulations of the governing conservation equations used to predict the thermal-hydraulic response of the nuclear reactor core to transient plant conditions.

Within the United States, there are several codes that are widely available for simulating the thermal-hydraulic response of a nuclear power plant.
These safety codes can be divided into two large categories: system analysis codes, and sub-channel analysis codes.
While there is a swath of overlap between the capabilities of these two categories, each has its own particular strengths and weaknesses.
The system analysis code often have extensive models available for large components such as steam generators, pumps, valves, containment, etc.
RELAP \cite{RELAP}, TRACE \cite{TRACE}, and MELCOR \cite{Summers1994} are three of the more well known of these system level safety analysis codes.
Other codes have extensive modeling capabilities for in-core physics: COBRA \cite{Thurgood1983c} and VIPRE are two examples of these sub-channel codes.
The differences between these various codes will be reviewed to compare current practices, examine recent research directions, and provide a context for the current work.

\section{Two-Phase Flow}
\label{sect:two_phase_flow}
The ability to model a fluid that undergoes phase change is a requirement of safety analysis codes for LWR.
A common aspect of the safety codes mentioned in this work is that they are based upon average quantities.

\begin{figure}[ht]
\caption{Two phase flow within a pipe.}
\label{fig:pipe_with_bubbles}
\begin{center}
\begin{tikzpicture}
\draw (-4,4) -- +(4,4);
\end{tikzpicture}
\end{center}
\end{figure}

There is no motivation to capture the interface between phases.
The modeling is accomplished via numerical solutions to a set of conservation laws.
The particular forms of the conservation laws can vary from code to code and is influenced by the assumptions that are made by the code developers.
The heart of the issue is the engineering judgment required to determine which physics are of sufficient importance to include, which physical closure laws can be experimentally determined, and what computational complexity is acceptable.

\subsection{Averaged Equations}
\label{subsect:assumptions}
There are several general assumptions that are made to reduce the complexity of the governing conservation laws of two-phase flow.
The first physically motivated simplification is that the exact interface between phases is not necessary for reactor safety.
This simplification allows averaging assumptions to be made.
Since the exact deterministic behavior of the fluid is no longer required, the governing equations will be subjected to an averaging procedure to produce conservation laws for average quantities.
There are several types of averaging that have been used to motivate the conservation laws.
The definition of average in the above sentence can have several meanings.
There are spatial, temporal, and ensemble averaging techniques, each of which has their own physical interpretations\cite{Drew1998, Todreas2011}.

\subsection{Governing Partial Differential Equations}
\label{subsect:pdes}
Additional assumptions have been made, and they wi
The conservation laws of interest are composed of four conservation of mass equations.
The following work deals with a two-phase, three-field formulation of two-phase flow.

The following equations result from an area-averaging process as discussed above.

\begin{equation}
\label{eqn:conservation_of_mass}
\frac{\partial \alpha_k \rho_k }{\partial t } + \nabla \cdot \left( \alpha_k \rho_k \vec{U}_k \right) = \Gamma^{'''}_k + S^{'''}_k + s_k
\end{equation}
\begin{equation}
\label{eqn:conservation_of_momentum}
\frac{\partial \alpha_k \rho_k \vec{U} }{\partial t } + \nabla \cdot \left( \alpha_k \rho_k \vec{U}_k \vec{U}_k \right) = -\alpha_k \nabla P + \alpha_k \vec{g} \Gamma^{'''}_k + S^{'''}_k + s_k
\end{equation}
\begin{equation}
\label{eqn:conservation_of_energy}
\frac{\partial \alpha_k \rho_k }{\partial t } + \nabla \cdot \left( \alpha_k \rho_k \vec{U}_k \right) = \Gamma^{'''}_k + S^{'''}_k + s_k
\end{equation}

One of the primary uses of COBRA is to simulate conditions where dispersed liquid within the flow could have a large impact upon the thermal-hydraulics performance of the nuclear reactor core.
The reason for this is because COBRA models the two-phase flow behavior using two discrete phases, liquid and gas, but allows for multiple fields within a given phase.
The ability to track different fields within a phase manifests itself in two important primary ways: the ability to account for the effects of con-condensable gases on condensation, and the ability to model the impact upon heat transfer by dispersed liquid droplets.

There are four equations representing the conservation of mass of the non-condensable gases, the continuous liquid field, the dispersed liquid field, and the total gaseous phase.
The general conservation of mass equation \eqref{eqn:conservation_of_mass} will yield each of the four conservation equations given appropriate assumptions and definitions for certain terms.

The left hand side of \eqref{eqn:conservation_of_mass} represents the Lagrangian derivative of the a given field $_k$.
The three terms on the right hand side represent inter-field, $S^{'''}_k$, inter-phase, $\Gamma_k$,  and external, $s_k$, sources or sinks of mass.
Since there are two liquid fields, the net phasic mass transfer, $\Gamma$, is apportioned between the continuous liquid field and the dispersed liquid field.
This division is given by \eqref{eqn:apportionment_of_mass_transfer}, where $\eta$ is a state dependent apportionment factor.

\begin{equation}
\label{eqn:apportionment_of_mass_transfer}
\Gamma = \Gamma_g = -( \Gamma_e + \Gamma_l ) =  \eta \Gamma + (1 - \eta)\Gamma
\end{equation}

The inter-field transfer of mass occurs only between the continuous and dispersed liquids, \eqref{eqn:entrainment_deentrainment}.

\begin{equation}
\label{eqn:entrainment_deentrainment}
S^{'''}_l + S^{'''}_e = 0
\end{equation}

Assumption that reduces the complexity of the conservation equations include the assumptions that mechanical equilibrium between the non-condensable gas field and the total gaseous field, $\vec{U}_{ncg} = \vec{U}_g$, thermal-equilibrium between different fields with the same phase, $ $, Dalton's law is applicable between the two gaseous fields, and that, most importantly, all fields share an equilibrium pressure.

Note that the momentum conservation equations are formulated in conservative form, this is a stark contrast between COBRA and some other common system analysis codes \cite{TRACE, RELAP} that use non-conservative forms for their momentum conservation laws.

COBRA uses two equations for phasic conservation of energy: the conservation of energy for the total liquid phase, \eqref{eqn:conservation_of_liq_energy}; and the conservation of energy for the total gaseous phase, \eqref{eqn:conservation_of_gas_energy}.
Several assumptions underlie these two equations.
The continuous liquid film is considered to be thermodynamic equilibrium with the dispersed liquid at a given point.

\begin{equation}
\label{eqn:conservation_of_liq_energy}
2 + 2 = 3
\end{equation}

\begin{equation}
\label{eqn:conservation_of_gas_energy}
2 + 4  + 3 = 2
\end{equation}

Being that COBRA was developed primarily as a sub-channel analysis tool, there is an assumption that the primary flow path is defined as inline with the gravity vector, which will be referred to as axial flow.
However, there is also the ability to model "gaps," flow orthogonal to the axial direction.
Another assumption is that the non-condensable gases are in mechanical equilibrium with the vapor field.
The conservation of momentum is applied in each flow direction to the three-fields: continuous liquid films, entrained liquid droplets, and total gaseous flow.
For the conservation of energy, COBRA-IE tracks the combined fluid energy and the combined gas energy.
In total, there are twelve physical conservation equations that are used for the fluid-mechanic solution within COBRA.

In addition, there is an advection equation for Interfacial Area Transport.

In a one-dimensional simulation, there will be nine governing conservation equations for fluid-mechanics.

\section{Numeric Discretization}
\label{sect:numeric_methods}

\subsection{Staggered Grid}
\label{subsect:topology}

The computational grid utilized in this work is a known as a staggered mesh.
With the staggered mesh, there are "continuity" meshes and there are "momentum" meshes; see \fig{fig:staggered_mesh}.
The conservation equations for mass and energy are solved at the center of the continuity cells.
The conservation equations for momentum are solved at the center of the momentum cells.
The edges of the continuity cells align with the center of the momentum cells and vice-verca.

\begin{figure}[ht]
\caption{A staggered mesh.}
\label{fig:staggered_mesh}
\begin{center}
\begin{tikzpicture}
\draw (-3,0) rectangle +(1,5);
\draw (0,-1) rectangle +(1,1) (0,0) rectangle +(1,1) (0,1) rectangle +(1,1) (0, 2) rectangle +(1,1) (0,3) rectangle +(1,1) (0,4) rectangle +(1,1) (0, 5) rectangle +(1,1);
\draw[dashed] (3,-0.5) rectangle +(1,1) (3,0.5) rectangle +(1,1) (3,1.5) rectangle +(1,1) (3, 2.5) rectangle +(1,1) (3,3.5) rectangle +(1,1) (3,3.5) rectangle +(1,1) (3, 4.5) rectangle +(1,1) ;
\draw[dashed] (-3,0) -- (4,0);
\draw[dashed] (-3,5) -- (4,5);
\end{tikzpicture}
\end{center}
\end{figure}

\subsection{Method-Of-Lines}
\label{subsect:numerics_explicit}
There are single-step temporal integration techniques.
There are multi-step methods.
Given the PDEs from \sect{subsect:pdes}, the Method-Of-Lines is used for the temporal integration \cite{LeVeque2007}.
The MOL methodology starts by spatially discritizing \eqref{equations_for_Stuff}, while leaving the temporal derivatives continuous.
Using the topological definitions from \sect{subsect:topology}, the system of conservation laws for the global domain can be represented by \eqref{eqn:MOL_1}, where $\vec{X}(t)$ is the temporally continuous vector of conserved quantities defined at grid points.
The generic function, $\vec{G}$, on the RHS of \eqref{eqn:MOL_1} represents the all of the terms in \eqref{stuff} expect the temporal derivative.
\begin{equation}
\label{eqn:MOL_1}
\frac{\partial \vec{X}(t)_j}{\partial t} = \vec{G}(\vec{X}(t))
\end{equation}

Within the safety analysis framework, the temporal derivative is approximated by a simple difference scheme, \eqref{eqn:simple_partial_t}.
\begin{equation}
\label{eqn:simple_partial_t}
\frac{\partial \vec{X}(t)_j}{\partial t} = \frac{ \vec{X}^{n+1}_{j} - \vec{X}^{n}_{j}}{t^{n+1}-t^{n}}, \quad \vec{X}^{n+1}_j = \vec{X}(t^{n+1})_j
\end{equation}

Where the continuous time variable is now evaluated at discrete points, $t^0, t^1, \ldots, t^N$, numbered zero through $N$, where $t^N$ represents the final time of interest.
The choice of temporal discretization of $\vec{G}$ is what leads to several methods of interest.

\subsubsection{Explicit}
\label{subsubsect:numerics_explicit}
The least computationally expensive MOL variant is known as a the fully explicit method.
The terminology explicit refers to the fact that the unknowns at $t^{n+1}$, $\vec{X}^{n+1}$, are function of the values at the present time $\vec{X}^{n}$ only.
This particular temporal approximation of $\vec{G}$, along with \eqref{eqn:MOL_1} and \eqref{eqn:simple_partial_t}, generates the explicit method for two phase flow, \eqref{eqn:explicit_two_phase}.

\begin{equation}
\label{eqn:explicit_two_phase}
\frac{ \vec{X}^{n+1}_{j} - \vec{X}^{n}_{j}}{t^{n+1}-t^{n}} = \vec{G}(\vec{X}^{n})
\end{equation}

While this particular methodology is the least computationally expensive, it has a severe weakness in the context of two-phase flow.
The weakness is Courant-Friedrichs-Lewy (CFL) limit imposed upon the time step.
The CFL limit is a relationship between the physical and temporal discretizations and characteristic time-scales of the problem of interest.
For the case of \eqref{eqn:explicit_two_phase}, the CFL limit is given in \eqref{eqn:cfl_explicit}.

\begin{equation}
\label{eqn:cfl_explicit}
\Delta t_j \lesssim \frac{\Delta x_j}{|\vec{u}_j|+|c_j|}
\end{equation}

Where $c$ represented the speed of sound within the fluid of interest, and $\vec{u}$ is the magnitude of a given phasic velocity.
The $\Delta t_j$ is calculated at every point within the domain using known local fluid conditions.
The $\Delta t$ chosen for $t^{n} \rightarrow t^{n+1}$ time-step is most restrictive value over the domain.

\begin{equation}
\label{eqn:global_cfl}
\Delta t = \min_{j \in \Omega} \Delta t_j
\end{equation}

States in words, the maximum permissible time-step size for the explicit method is limited by the local speed of sound.
This is a severe penalty on computational run-time.
There are no physics of interest that are attempting to be modeled on the time-scale of the inverse speed of sound.
This limitation of the explicit method prompted the development of alternative methods that were capable of exceeding this limitation.

\subsubsection{Implicit}
\label{subsubsect:numerics_fully_implicit}
The CFL limit discussed in section \ref{subsubsect:numerics_explicit} is a product of the explicit functional dependence of the $\vec{G}$ from \eqref{eqn:MOL_1} upon only $t^n$ variables.
A simple, but computationally expensive, way to eliminate the CFL limit is to utilize a fully-implicit formulation.
A fully-implicit formulation is one where $\vec{G}$ is function only of unknown variables, \eqref{eqn:implicit_MOL}.

\begin{equation}
\label{eqn:implicit_MOL}
\frac{ \vec{X}^{n+1}_{j} - \vec{X}^{n}_{j}}{t^{n+1}-t^{n}} = \vec{G}(\vec{X}^{n+1})
\end{equation}

This particular formulation has the advantage of not being limited by a CFL number.
However, recall that the CFL is for stability purposes only, not accuracy.
In addition, the solution of \eqref{eqn:implicit_MOL} is computationally expense as that $\vec{G}(\vec{X}^{n+1})$ is a highly nonlinear function requiring the use of nonlinear solvers to obtain a solution.

\subsubsection{Semi-Implicit}
\label{subsubsect:numerics_semi_implicit}

The existance of the sonic CFL limitation led to the development of the semi-implicit methodology \cite{Liles1978}.
To obtain the semi-implicit formulation, the $\vec{G}$ in \eqref{eqn:MOL_1} is modified and combined with \eqref{eqn:simple_partial_t} to produce \eqref{eqn:semi_implict_MOL}.

\begin{equation}
\label{eqn:semi_implicit_MOL}
\frac{ \vec{X}^{n+1}_{j} - \vec{X}^{n}_{j}}{t^{n+1}-t^{n}} = \vec{G}(\vec{X}^{n},\vec{X}^{n+1})
\end{equation}

$\vec{G}$ is now a function of both known and unknown variables, hence the name semi-implicit. 
The particular formulation of the semi-implicit methodology is of importance to later sections, so a detailed description of the conservation laws from \sect{sect:two_phase} is provided in equation \eqref{eqnarray:semi_implicit}.

\begin{IEEEeqnarray}{lCl}
2 & = & 2
\end{IEEEeqnarray}

\begin{algo}[H]
\caption{Semi-Implicit Linear Solution Algorithm}
\label{algo:semi_implicit}
\setlength{\baselineskip}{0.625\baselineskip}
\begin{algorithmic}[1]
\Require $\Vec{x}^{0}$ and $t^{0}$
\Set $n = 0$
\Loop \; Take a Time Step
    \Set $\vec{x}^{n}$
    \Calculate $\Delta t$
    \State $t^{n+1} : = t^{n} + \Delta t$
    \BlackBox Solve for $\vec{x}^{n+1}$
    \Test CCFL \Comment{Time-step Failure Mechanism (ccfl\_fail) }
    \BlackBox Interfacial Area Transport Equation
    \Calculate Courant Numbers
\EndLoop{\;$n = n+1$}
\end{algorithmic}
\end{algo}

\subsection{Multi-stage Methods}
\label{subsect:numerics_multistep}
An alternative formulation for the temporal derivative is a multi-stage method.
These methods involve predictor and corrector steps.


\subsubsection{SETS}
\label{subsubsect:numerics_sets}
To overcome the material Courant limit exhibited by the semi-implicit method, several alternatives have been developed.
One alternative, known as the the stability-enhancing two-step method (SETS) \cite{Mahaffy1982}, eliminates the material Courant limit by introducing multiple iterative refinement of the solution within a given time-step.

\subsubsection{Nearly Implicit}
\label{subsubsect:numerics_nearly_implicit}
Another multi-stage method is called the Nearly-Implicit method.

\section{Domain Coupling}
\label{sect:code_coupling}
There are several options to couple the specialized capabilities of system analysis codes to the detailed physics of a subchannel analysis code.
These methodologies, are constantly evolving.
The types of methods follow the layout of method of lines.

\subsection{Explicit}
\label{subsect:coupling_explicit}
The first coupling methodology proposed was explicit coupling.
This methodology involved passing information between two different codes at the beginning of a time-step.


\subsection{Semi-Implicit}
\label{subsect:coupling_semi_implicit}
The desire to overcome the instabilities outlined in the previous section, a semi-implicit methodology was proposed that made use of Parallel Virtual Machine (PVM).
PVM is a piece of software that was developed for the purpose of passing information between programs running in parallel \citet{someone}. 
The ability to pass information between software is key to the semi-implicit stuff. 

\subsection{Implicit}
\label{subsect:coupling_implicit}
The concept of implicitly coupling different physics is sufficiently attractive. 


\section{Implicit Nonlinearities}
\label{sect:nonlinearities}
In section \sect{sect:numeric_methods}, several numeric methods for the discritization of the equations \eqref{eqn:conservation_of_energy} were demonstrated.
For the two-phase flow equations of interest, the conserved variables at $t^{n+1}$ are nonlinear functions of the indepedent parameters.
These temporal nonlinearities exist in all numeric methods.
For those methods that has any implicit variables on the RHS, there are additional nonlinearities introduced.
In order to deal with these nonlinearities, there are two general branches of solution techniques.
A choice can be made to not resolve the nonlinearities, or an iterative procedure can be introduced to resolve the nonlinearities of interest.

\subsection{Newton's Method}
\label{subsect:newtons_method}
The primary method used to resolve the non-linearities in the governing equations is the use of a Newton's method.
Newton's method is an optimization algorithm that is particularly well suited for algebriac-equations

\subsection{Single-shot Linearization}
\label{subsect:single_shot}
If the nonlinearities in the numeric method are not resolved.

\section{Temporal Convergence}
\label{sect:temporal_convergence}
Of primary use in the field of nuclear reactor safety analysis is simulation.
The ability to predict the behavior of reactors during off-normal events is the key to the licensing and the operation of nuclear power plants.
Within the United States, this simulation capacity is provided by a relatively small number of main stream software suites, among which are the RELAP variants, COBRA variants, and MELCOR.
While each of these software products varies in their models and implementations, the underlying numeric techniques and capabilities are similar.

\subsection{Time Step Selection}
\label{subsect:time_step_selection}

\subsection{Time Step Failure}
\label{subsect:time_step_failure}
There are two common methods for dealing with a potentially poor time-step in sub-channel codes: prediction and mitigation.
The predictive methodology is the less commonly applied of the two methods.
It uses information about the explicit portion of the nonlinear residual to identify situations where the linearization point may be poor.
In COBRA, this particular method is used only for the prediction of non-condenable gas appearance.

Mitigation, the second method, is the more common and actively used strategy.
This strategy can be further subdivided into two categories: limiting and failure.
There is an extensive set of limiting criteria.

\section{Review}
\label{sect:review}

\section{Research Objective}
The objective of this dissertation is the design, implementation, and evaluation of a practical non-linear solution framework for reactor safety systems codes.
Specifically, an efficient and reliable solution methodology to the two-phase, three-field, fluid-dynamics and the solid-structure heat transfer system of coupled non-linear partial differential equations is sought.
The specific methodology should be capable of obtaining a consistent solution to the system of PDEs while also possessing. \cite{Aktas1996}
The limiting behavior of nuclear reactors occurs during the end portion of a severe accident.
The primary point of investigation is the use of domain decomposition for the purpose of refining the solution to the nonlinear conservation within COBRA-IE.
The domain decomposition will take place utilizing a generic semi-implicit coupling methodology developed by \citet{Weaver2002}.
The ability to isolate a subdomain of the problem and increase ability of the software to resolve the complex nonlinear physics that occur near the quench front of a reflood transient.
This methodology will hopefully increase the predictive capabilities of safety analysis codes while keeping the computational overhead as low as reasonable possible.