\chapter{Domain Decomposition}
\label{chap:domain_decomposition}
The governing partial differential equations described in \sect{subsect:governing_equations} contain nonlinearities that distributed in both space and time.
In the absence of nonlinear physics a single Newton step is adequate to solve the governing set of discrete algebraic equations.
However, for a given spatial mesh when nonlinearities are present if the number of Newton steps is limited to one, then the only way to resolve those nonlinearities is to refine the temporal discretization.
If the number of Newton steps is not limited to one, then the nonlinearities will be resolved for a fixed temporal discretization.
When the nonlinearities are isolated to a given nonlinear portion of the domain, the additional Newton steps do not improve the solution in the linear portion of the domain.
The ability to resolve the nonlinear physics only where they occur could potentially provide a way to reduce the computational cost associated with resolving the nonlinear error for a given timestep.
The following section contains three sections that describe the mathematical formulation of the domain decomposition, a description of its implementation, and several problems that were used to verify that the algorithm had been implemented properly.

%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
\section{Mathematical Formulation}
\label{sec:dd_math}

\cobra{} uses a staggered mesh to represent the computational domain.
The domain decomposition takes place within the context of a Newton step.
The starting place for the formulation will be the continuity equations for a generic volume,  \fig{fig:single_volume}.
The edges of the volume will be labeled $x_{j \pm \onehalf}$.
Without loss of generality, the following formulation will have advection only in one spatial dimension and will not contain the terms associated with the exchange of mass and energy between the different fields and phases.
The convection in this work is that the normal vector for a given volume will be outwards directed.
A positive flow corresponds to flow in the direction of increasing $x_{j}$.  

The corresponding continuity equations for a given volume are then given by \eqref{eqn:advection_of_ncg_mass} -- \eqref{eqn:advection_of_vap_mass}.

\begin{IEEEeqnarray}{rCl}
\label{eqn:advection_of_ncg_mass}
V_{j}\frac{(\alpha_{g} \rho_{n})^{n+1, k}_{j} - (\alpha_{g} \rho_{n})^{n}_{j} }{ \dt } + \dot{m}^{n+1, k}_{g, j + \onehalf}\frac{\don{\alpha^{n}_{g} \rho^{n}_{n}}^{n+1,k}_{d, j+\onehalf}}{\ave{\alpha_{g} \rho_{g}}^{n}_{a, j + \onehalf}} - \dot{m}^{n+1, k}_{g, j - \onehalf}\frac{\don{\alpha^{n}_{g} \rho^{n}_{n}}^{n+1,k}_{d, j-\onehalf}}{\ave{\alpha_{g} \rho_{g}}^{n}_{a, j - \onehalf}} & = & 0 \\
%
\label{eqn:advection_of_liq_mass}
V_{j}\frac{(\alpha_{l} \rho_{l})^{n+1, k}_{j} - (\alpha_{l} \rho_{l})^{n}_{j} }{ \dt } + \dot{m}^{n+1, k}_{l, j + \onehalf}\frac{\don{ \alpha^{n}_{l} \rho^{n}_{l} }^{n+1,k}_{d, j+\onehalf}}{\ave{\alpha_{l} \rho_{l}}^{n}_{a, j + \onehalf}} - \dot{m}^{n+1, k}_{l, j - \onehalf}\frac{\don{\alpha^{n}_{l} \rho^{n}_{l}}^{n+1,k}_{d, j-\onehalf}}{\ave{\alpha_{l} \rho_{l}}^{n}_{a, j - \onehalf}} & = & 0 \\
%
\label{eqn:advection_of_gas_energy}
V_{j}\frac{(\alpha_g \rho_g h_g)^{n+1, k}_{j} - (\alpha_g \rho_g h_g)^{n}_{j} }{ \dt } + \dot{m}^{n+1, k}_{g, j + \onehalf}\frac{\don{\alpha^n_g \rho^n_g h^{n}_{g}}^{n+1,k}_{d, j+\onehalf}}{\ave{\alpha_{g} \rho_{g}}^{n}_{a, j + \onehalf}} - \dot{m}^{n+1, k}_{g, j - \onehalf}\frac{\don{\alpha^{n}_{g} \rho^{n}_{g} h^{n}_{g}}^{n+1,k}_{d, j-\onehalf}}{\ave{\alpha_{g} \rho_{g}}^{n}_{a, j - \onehalf}} &  & \\
%
\nonumber
- V_{j} \alpha^{n}_{g} \frac{P^{\, n+1, k}_{j} - P^{\,n}_{j} }{\dt{}} & = & 0 \\
\label{eqn:advection_of_liq_energy}
V_{j}\frac{(\alpha_{l} \rho_{l} h_{l})^{n+1, k}_{j} - (\alpha_{l} \rho_{l} h_{l} )^{n}_{j} }{ \dt } + \dot{m}^{n+1, k}_{l, j + \onehalf}\frac{\don{\alpha^{n}_{l} \rho^{n}_{l} h^{n}_{l} }^{n+1, k}_{d, j+\onehalf}}{\ave{\alpha_{l} \rho_{l}}^{n}_{a, j + \onehalf}} - \dot{m}^{n+1, k}_{l, j - \onehalf}\frac{\don{\alpha^{n}_{l} \rho^{n}_{l} h^{n}_{l}}^{n+1, k}_{d, j-\onehalf}}{\ave{\alpha_{l} \rho_{l}}^{n}_{a, j - \onehalf}} &  &  \\
%
\nonumber
+ \dot{m}^{n+1, k}_{e, j + \onehalf}\frac{\don{\alpha^{n}_{e} \rho^{n}_{l} h^{n}_{l}}^{n+1, k}_{d, j+\onehalf}}{\ave{\alpha_{e} \rho_{l}}^{n}_{a, j + \onehalf}} - \dot{m}^{n+1, k}_{e, j - \onehalf}\frac{\don{\alpha^{n}_{e} \rho^{n}_{l} h^{n}_{l}}^{n+1, k}_{d, j-\onehalf}}{\ave{\alpha_{e} \rho_{l}}^{n}_{a, j - \onehalf}} - V_{j} ( 1 - \alpha^{n}_{g})\frac{P^{\, n+1, k}_{j} - P^{\,n}_{j} }{\dt{}}& = & 0 \\
%
\label{eqn:advection_of_ent_mass}
V_{j}\frac{(\alpha_{e} \rho_{l})^{n+1, k}_{j} - (\alpha_{e} \rho_{l})^{n}_{j} }{ \dt } + \dot{m}^{n+1, k}_{e, j + \onehalf}\frac{\don{\alpha^{n}_{e} \rho^{n}_{l}}^{n+1,k}_{d, j+\onehalf}}{\ave{\alpha_{e} \rho_{l}}^{n}_{a, j + \onehalf}} - \dot{m}^{n+1, k}_{e, j - \onehalf}\frac{\don{\alpha^{n}_{e} \rho^{n}_{l}}^{n+1,k}_{d, j-\onehalf}}{\ave{\alpha_{e}\rho_{l}}^{n}_{a, j - \onehalf}} & = & 0 \\
%
\label{eqn:advection_of_vap_mass}
V_{j}\frac{(\alpha_{g} \rho_{v})^{n+1, k}_{j} - (\alpha_{g} \rho_{v})^{n}_{j} }{ \dt } + \dot{m}^{n+1, k}_{g, j + \onehalf}\frac{\don{\alpha^{n}_{g} \rho^{n}_{v}}^{n+1,k}_{d, j+\onehalf}}{\ave{\alpha_{g} \rho_{g}}^{n}_{a, j + \onehalf}} - \dot{m}^{n+1, k}_{g, j - \onehalf}\frac{\don{\alpha^{n}_{g} \rho^{n}_{v}}^{n+1,k}_{d, j-\onehalf}}{\ave{\alpha_{g} \rho_{g}}^{n}_{a, j - \onehalf}} & = & 0
\end{IEEEeqnarray}

It will be advantageous to a matrix, $\vec{\Xi}$, that converts the momenta at a continuity volume's edge to fluxes of mass and energy; \eqref{eqn:flux_matrix} will serve this purpose.

\begin{equation}
\label{eqn:flux_matrix}
\vec{\Xi}^{n+1, k}_{j \pm \onehalf} = \begin{bmatrix}
%
 0 & \frac{\don{\alpha^{n}_{g} \rho^{n}_{n}}^{n+1,k}_{d}}{\ave{\alpha_{g} \rho_{g}}^{n}_{a}} & 0 \\
%
\frac{\don{\alpha^{n}_{l}\rho^{n}_{l}}^{n+1,k}_{d}}{\ave{\alpha_{l} \rho_{l}}^{n}_{a}} & 0 & 0 \\
%
0 & \frac{\don{\alpha^{n}_{g} \rho^{n}_{g} h^{n}_{g}}^{n+1,k}_{d}}{\ave{\alpha_{g} \rho_{g}}^{n}_{a}} & 0 \\
%
\frac{\don{\alpha^{n}_{l}\rho^{n}_{l} h^{n}_{l}}^{n+1,k}_{d}}{\ave{\alpha_{l} \rho_{l}}^{n}_{a}} & 0 & \frac{\don{\alpha^{n}_{e} \rho^{n}_{l} h^{n}_{l}}^{n+1, k}_{d}}{\ave{\alpha_{e} \rho_{l}}^{n}_{a}} \\
%
0 & 0 & \frac{ \don{\alpha^{n}_{e} \rho^{n}_{l}}^{n+1, k}_{d}}{ \ave{\alpha_{e} \rho_{l}}^{n}_{a}} \\
%
0 & \frac{ \don{\alpha^{n}_{g} \rho^{n}_{v}}^{n+1, k}_{d}}{ \ave{\alpha_{g} \rho_{g}}^{n}_{a}} & 0
\end{bmatrix}_{j \pm \onehalf}
\end{equation}

The momenta vector is given by \eqref{eqn:momenta_vector}.

\begin{equation}
\label{eqn:momenta_vector}
\vec{\dot{m}} = \begin{bmatrix}
\dot{m}_{l} \\
\dot{m}_{g} \\
\dot{m}_{e}
\end{bmatrix}
\end{equation}

The fluxes into or out of a given volume will be denoted by $\vec{\Psi}$, \eqref{eqn:flux_vector}.

\begin{equation}
\label{eqn:flux_vector}
\vec{\Psi} = \vec{\Xi} \cdot \vec{\dot{m}}
\end{equation}

With \eqref{eqn:flux_matrix} through \eqref{eqn:flux_vector}, \eqref{eqn:advection_of_ncg_mass} -- \eqref{eqn:advection_of_vap_mass} can be written as the vector of equations \eqref{eqn:short_hand_continuity}.

\begin{equation}
\label{eqn:short_hand_continuity}
\frac{V_j}{\dt} \begin{bmatrix}
(\alpha_{g} \rho_{n})^{n+1, k}_{j} - (\alpha_{g} \rho_{n})^{n}_{j} \\
\alpha_{l} \rho_{l})^{n+1, k}_{j} - (\alpha_{l} \rho_{l})^{n}_{j} \\
(\alpha_{g} \rho_{g} h_{g})^{n+1, k}_{j} - (\alpha_{g} \rho_g h_{g})^{n}_{j} - \alpha^{n}_{g} ( P^{\, n+1, k}_{j} - P^{\,n}_{j} )  \\
(\alpha_{l} \rho_{l} h_{l})^{n+1, k}_{j} - (\alpha_{l} \rho_{l} h_{l} )^{n}_{j} - (1 - \alpha^{n}_{g}) ( P^{\, n+1, k}_{j} - P^{\,n}_{j} )\\
(\alpha_{e} \rho_{l})^{n+1, k}_{j} - (\alpha_{e} \rho_{l})^{n}_{j} \\
(\alpha_{g} \rho_{v})^{n+1, k}_{j} - (\alpha_{g} \rho_{v})^{n}_{j} 
\end{bmatrix} + \vec{\Psi}^{n+1, k}_{j + \onehalf} - \vec{\Psi}^{n+1, k}_{j - \onehalf}= 0
\end{equation}

The residuals of the continuity equations at a given point, \eqref{eqn:short_hand_continuity}, will be known as $\vec{F}_{c, j}$.
Let the Jacobian of \eqref{eqn:short_hand_continuity} with respect to the associated nonlinear parameters as defined in \eqref{eqn:independentVariables} be defined as $J^{k}_{c, j}$.
The Jacobian of \eqref{eqn:short_hand_continuity} with respect to adjacent momenta, \eqref{eqn:momenta_vector}, is given by $\vec{\Xi}^{k}_{c, j \pm \onehalf}$.
The domain decomposition method is based upon fluxes into and out of a domain.

Up to this point, the discussion of the linear and nonlinear algorithms have avoided the use of full nonlinear system.
However, it is now time to venture into unknown territories.
For this example, imagine the following model:

HERE THERE IS A PICTURE OF TWO VOLUMES VERTICALLY CONNECTED.

The following procedure will show the development of the domain decomposition algorithm.

\begin{equation}
\label{eqn:domainMatrix}
 \begin{bmatrix} 
\vec{J}_{c_1} & \vec{\Xi}_{c_1,m_1} & \vec{0} \\
\vec{J}_{m_1,c_1} & \vec{J}_{m_1} & \vec{J}_{m_1,c_2}  \\
\vec{0} & \vec{\Xi}_{c_2,m_1} & \vec{J}_{c_2} \\
 \end{bmatrix} \begin{bmatrix}
 \vec{\delta c}_{1} \\
 \vec{\delta m}_{1} \\
 \vec{\delta c}_{2} \\
\end{bmatrix}  = -\begin{bmatrix}
 \vec{F}_{c_1} \\
 \vec{F}_{m_1} \\
 \vec{F}_{c_2} \\
\end{bmatrix}
 \end{equation}
 
 \begin{equation}
\label{eqn:domainMatrix2}
 \begin{bmatrix} 
\vec{J}_{c_1} & \vec{\Xi}_{c_1,m_1} & \vec{0} \\
\vec{J}_{m_1,c_1} & \vec{J}_{m_1} & \vec{J}_{m_1,c_2}  \\
\vec{0} & \vec{\Xi}_{c_2,m_1} & \vec{J}_{c_2} \\
 \end{bmatrix} \begin{bmatrix}
 \vec{\delta c}_{1} \\
 \vec{\delta m}_{1} \\
 \vec{\delta c}_{2} \\
\end{bmatrix}  = -\begin{bmatrix}
 \vec{F}_{c_1} \\
 \vec{F}_{m_1} \\
 \vec{F}_{c_2} \\
\end{bmatrix}
 \end{equation}

 
% First, the momentum volume equations, rows one, three, and five of the linear system \eqref{eqn:si_solve}, are multiplied by their inverse diagonal Jacobian entries, $\vec{J}_{m_k}$.
% The off-diagonal entries for the momentum equations are now $\vec{J}^{-1}_{m_k}\vec{J}_{m_k,c_j}$ where $j$ is the index of the connected continuity volumes.
% Since the $J_{m_k,c_j}$ terms only contain derivatives with respect to the pressure for the adjoining continuity volumes, the [3 x 6] matrix product $\vec{J}^{-1}_{m_k}\vec{J}_{m_k,c_j}$ will be referred to as $\frac{\partial \vec{m}_k}{\partial P_j}$.
% This product matrix only contains entries in the sixth column.
% Using the above notation, the resulting system is given in \eqref{eqn:si_solve_1}.
% 
%  \begin{equation}
% \label{eqn:si_solve_1}
% \begin{bmatrix} 
% \vec{I} & \frac{\partial \vec{m}_1}{\partial P_1} & \vec{0} & \vec{0} & \vec{0} & \vec{0}\\
% \vec{J}_{c_1,m_1} & \vec{J}_{c_1} & \vec{J}_{c_1,m_2} & \vec{0} & \vec{0} & \vec{0} \\
% \vec{0} & \frac{\partial \vec{m}_2}{\partial P_1} & \vec{I} & \frac{\partial \vec{m}_2}{\partial P_2} & \vec{0} & \vec{0} \\
% \vec{0} & \vec{0} & \vec{J}_{c_2,m_2} & \vec{J}_{c_2} & \vec{J}_{c_2,m_3} & \vec{0} \\
% \vec{0} & \vec{0} & \vec{0} & \frac{\partial \vec{m}_{3}}{\partial P_2} & \vec{I} & \frac{\partial \vec{m}_{3}}{\partial P_3} \\ 
% \vec{0} & \vec{0} & \vec{0} & \vec{0} & \vec{J}_{c_3,m_3} & \vec{J}_{c_3}  
% \end{bmatrix} \begin{bmatrix}
% \vec{\delta m}_{1} \\ \vec{\delta c}_{1} \\
% \vec{\delta m}_{2} \\ \vec{\delta c}_{2} \\
% \vec{\delta m}_{3} \\ \vec{\delta c}_{3}
%\end{bmatrix}  = -\begin{bmatrix}
% \vec{J}^{-1}_{m_1}\vec{F}_{m_1} \\ \vec{F}_{c_1} \\
% \vec{J}^{-1}_{m_2}\vec{F}_{m_2} \\ \vec{F}_{c_2} \\
% \vec{J}^{-1}_{m_3}\vec{F}_{m_3} \\ \vec{F}_{c_3} \end{bmatrix}
% \end{equation}
%
%Second, the momentum equations are used to eliminate the $\vec{J}_{c_k,m_k}$ entries from the continuity volumes.
%The resulting equation set, \eqref{eqn:si_solve_2}, no longer has equations for the momentum volumes.
%
%\begin{IEEEeqnarray}{rl}
%\label{eqn:si_solve_2}
%\begin{bmatrix} 
%\vec{J}_{c_1} - \vec{J}_{c_1,m_1}\frac{\partial \vec{m}_1}{\partial P_1} - \vec{J}_{c_1,m_2}\frac{\partial \vec{m}_2}{\partial P_1} &
%-\vec{J}_{c_1,m_2}\frac{\partial \vec{m}_2}{\partial P_2} &
%\vec{0} \\
%-\vec{J}_{c_2,m_2}\frac{\partial \vec{m}_2}{\partial P_1} & 
%\vec{J}_{c_2} - \vec{J}_{c_2,m_2}\frac{\partial \vec{m}_2}{\partial P_2}-\vec{J}_{c_2,m_3}\frac{\partial \vec{m}_3}{\partial P_2} &
%-\vec{J}_{c_2,m_3}\frac{\partial \vec{m}_3}{\partial P_3} \\
% \vec{0} &
%-\vec{J}_{c_3,m_3}\frac{\partial \vec{m}_3}{\partial P_2} &
%\vec{J}_{c_3} -\vec{J}_{c_3,m_3}\frac{\partial \vec{m}_3}{\partial P_3} 
%\end{bmatrix} &\begin{bmatrix}
%\vec{\delta c}_{1} \\
%\vec{\delta c}_{2} \\
%\vec{\delta c}_{3}
%\end{bmatrix} \nonumber \\
% = -\begin{bmatrix}
%\vec{F}_{c_1} -
%\vec{J}_{c_1,m_1}\vec{J}^{-1}_{m_1}\vec{F}_{m_1}-\vec{J}_{c_1,m_2}\vec{J}^{-1}_{m_2}\vec{F}_{m_2} \\
%\vec{F}_{c_2} - 
%\vec{J}_{c_2,m_2}\vec{J}^{-1}_{m_2}\vec{F}_{m_2}-\vec{J}_{c_2,m_3}\vec{J}^{-1}_{m_3}\vec{F}_{m_3} \\
%\vec{F}_{c_3} - 
%\vec{J}_{c_3,m_3}\vec{J}^{-1}_{m_3}\vec{F}_{m_3}
%\end{bmatrix} &
% \end{IEEEeqnarray}
%
%The off-diagonal entries of the reduced Jacobian matrix in \eqref{eqn:si_solve_2}, $\vec{J}_{c_i,m_j}\frac{\partial \vec{m}_j}{\partial P_k}$ will be denoted by $\vec{C}_{c_i,P_j}$ as they represent the change in the continuity variables in volume $i$ due to the change in the pressure of continuity volume $j$.
%The [6 x 6] matrix, $\vec{C}_{c_i,P_j}$, contains only entries in the last column, which correspond to the inter-continuity pressure coupling terms.
%The diagonal entries of the reduced Jacobian and the right-hand side entries will be referred to as $\vec{J}^{*}_{c_i}$ and $\vec{F}^{*}_{c_i}$.
%With this new nomenclature, \eqref{eqn:si_solve_2} can be restated as \eqref{eqn:si_solve_3}.
%
%  \begin{equation}
% \label{eqn:si_solve_3}
% \begin{bmatrix} 
% \vec{J}^{*}_{c_1} & \vec{C}_{c_1,P_2} & \vec{0} \\
% \vec{C}_{c_2,P_1} & \vec{J}^{*}_{c_2} & \vec{C}_{c_2,P_3} \\
% \vec{0}           & \vec{C}_{c_3,P_2} & \vec{J}^{*}_{c_3}
% \end{bmatrix} \begin{bmatrix}
% \vec{\delta c}_{1} \\
% \vec{\delta c}_{2} \\
% \vec{\delta c}_{3}
%\end{bmatrix}  = -\begin{bmatrix}
% \vec{F}^{*}_{c_1} \\
% \vec{F}^{*}_{c_2} \\
% \vec{F}^{*}_{c_3}
%\end{bmatrix}
% \end{equation}
%
%Step three is to multiply each row by the $\vec{L}^{-1}_{c_i}$ portion of the LU decomposition without pivoting of $\vec{J}^{*}_{c_i}$, \eqref{eqn:si_solve_4}
%
%  \begin{equation}
% \label{eqn:si_solve_4}
% \begin{bmatrix} 
% \vec{U}^{*}_{c_1} & \vec{L}^{-1}_{c_1}\vec{C}_{c_1,P_2} & \vec{0} \\
% \vec{L}^{-1}_{c_2}\vec{C}_{c_2,P_1} & \vec{U}^{*}_{c_2} & \vec{L}^{-1}_{c_2}\vec{C}_{c_2,P_3} \\
% \vec{0}           & \vec{L}^{-1}_{c_3}\vec{C}_{c_3,P_2} & \vec{U}^{*}_{c_3}
% \end{bmatrix} \begin{bmatrix}
% \vec{\delta c}_{1} \\
% \vec{\delta c}_{2} \\
% \vec{\delta c}_{3}
%\end{bmatrix}  = -\begin{bmatrix}
% \vec{L}^{-1}_{c_1}\vec{F}^{*}_{c_1} \\
% \vec{L}^{-1}_{c_2}\vec{F}^{*}_{c_2} \\
% \vec{L}^{-1}_{c_3}\vec{F}^{*}_{c_3}
%\end{bmatrix}
% \end{equation}
% 
%By isolating the last row from each continuity block and dividing that row by its diagonal entry, a resulting matrix for the pressure update in every continuity volume is obtained, \eqref{eqn:si_pressure_matrix}. 
%For a problem with $N$ continuity volumes, the resulting pressure matrix, \eqref{eqn:si_pressure_matrix}, will be $N$ x $N$.
%For the simple geometry considered in this example, the resultant pressure matrix is a tridiagonal matrix.
%However, this is not the case for more complex geometries.
%
%  \begin{equation}
% \label{eqn:si_pressure_matrix}
% \begin{bmatrix} 
% 1 & \frac{\vec{L}^{-1}_{c_1}\vec{C}_{c_1,P_2}[6]}{\vec{U}^{*}_{c_1}[6]} & \vec{0} \\
% \frac{\vec{L}^{-1}_{c_2}\vec{C}_{c_2,P_1}[6]}{\vec{U}^{*}_{c_2}[6]} & 1 & \frac{\vec{L}^{-1}_{c_2}\vec{C}_{c_2,P_3}[6]}{\vec{U}^{*}_{c_2}[6]} \\
% \vec{0}           & \frac{\vec{L}^{-1}_{c_3}\vec{C}_{c_3,P_2}[6]}{\vec{U}^{*}_{c_3}[6]} & 1
% \end{bmatrix} \begin{bmatrix}
% \vec{\delta P}_{1} \\
% \vec{\delta P}_{2} \\
% \vec{\delta P}_{3}
%\end{bmatrix}  = -\begin{bmatrix}
% \frac{\vec{L}^{-1}_{c_1}\vec{F}^{*}_{c_1}[6]}{\vec{U}^{*}_{c_1}[6]} \\
% \frac{\vec{L}^{-1}_{c_2}\vec{F}^{*}_{c_2}[6]}{\vec{U}^{*}_{c_2}[6]} \\
% \frac{\vec{L}^{-1}_{c_3}\vec{F}^{*}_{c_3}[6]}{\vec{U}^{*}_{c_3}[6]}
%\end{bmatrix}
% \end{equation}
%
%In step four, the pressure matrix is then solved for the pressure updates in every continuity volume.
%This step is performed using either the sparse-matrix solver, SuperLU \cite{Li1999} or direct Gaussian elimination. 
%
%Step five is to use the vector of pressure updates to obtain the continuity updates in every volume from \eqref{eqn:si_solve_4} and to obtain the updates for the momentum variables from the momentum rows of \eqref{eqn:si_solve_1}.
%
%This five-step process provides an overview of the solution technique of the semi-implicit method used in \cobra{}.


%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
\section{Implementation in \cobra{}}
\label{sec:dd_algo}

The algorithmic implementation of the domain decomposition algorithm is now detailed.
This is going to be long.
Supposedly.

I am a single volume:

\begin{figure}[ht]
\centering
\input{images/isoparametric_volume}
\caption{A single continuity volume.}
\label{fig:single3dvol}
\end{figure}


%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
\section{Algorithmic Considerations}
\label{sect:dd_algo_con}

Are there any algorithmic considerations?
I am sure there are.
