\chapter{Domain Decomposition}
\label{chap:domain_decomposition}
The governing partial differential equations described in \sect{subsect:governing_equations} contain nonlinearities that are distributed in both space and time.
In the absence of nonlinear physics a single Newton step is adequate to solve the governing set of discrete algebraic equations.
However, for a given spatial mesh when nonlinearities are present if the number of Newton steps is limited to one, then the only way to resolve those nonlinearities is to refine the temporal discretization.
If the number of Newton steps is not limited to one, then the nonlinearities may be resolved for a fixed temporal discretization.
When the nonlinearities are isolated to a given nonlinear portion of the domain, the additional Newton steps do not improve the solution in the linear portion of the domain.
The ability to resolve the nonlinear physics only where they occur could potentially provide a way to reduce the computational cost associated with resolving the nonlinear error for a given timestep.
The following section contains three sections that describe the mathematical formulation of the domain decomposition, a description of its implementation, and several problems that were used to verify that the algorithm had been implemented properly.

%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
\section{Mathematical Formulation}
\label{sec:dd_math}

\cobra{} uses a staggered mesh to represent the computational domain.
The domain decomposition takes place within the context of a Newton step.
The starting place for the formulation will be the continuity equations for a generic volume,  \fig{fig:single_volume}.
The edges of the volume will be labeled $x_{j \pm \onehalf}$.
Without loss of generality, the following formulation will have advection only in one spatial dimension and will not contain the terms associated with the exchange of mass and energy between the different fields and phases.
The convection in this work is that the normal vector for a given volume will be outwards directed.
A positive flow corresponds to flow in the direction of increasing $x_{j}$.  

The corresponding continuity equations for a given volume are then given by \eqref{eqn:advection_of_ncg_mass} -- \eqref{eqn:advection_of_vap_mass}.

\begin{IEEEeqnarray}{rCl}
\label{eqn:advection_of_ncg_mass}
V_{c,j}\frac{(\alpha_{g} \rho_{n})^{n+1, k}_{j} - (\alpha_{g} \rho_{n})^{n}_{j} }{ \dt{} } + \dot{m}^{n+1, k}_{g, j + \onehalf}\frac{\don{\alpha^{n}_{g} \rho^{n}_{n}}^{n+1,k}_{d, j+\onehalf}}{\ave{\alpha_{g} \rho_{g}}^{n}_{a, j + \onehalf}} - \dot{m}^{n+1, k}_{g, j - \onehalf}\frac{\don{\alpha^{n}_{g} \rho^{n}_{n}}^{n+1,k}_{d, j-\onehalf}}{\ave{\alpha_{g} \rho_{g}}^{n}_{a, j - \onehalf}} & = & 0 \\
%
\label{eqn:advection_of_liq_mass}
V_{c,j}\frac{(\alpha_{l} \rho_{l})^{n+1, k}_{j} - (\alpha_{l} \rho_{l})^{n}_{j} }{ \dt } + \dot{m}^{n+1, k}_{l, j + \onehalf}\frac{\don{ \alpha^{n}_{l} \rho^{n}_{l} }^{n+1,k}_{d, j+\onehalf}}{\ave{\alpha_{l} \rho_{l}}^{n}_{a, j + \onehalf}} - \dot{m}^{n+1, k}_{l, j - \onehalf}\frac{\don{\alpha^{n}_{l} \rho^{n}_{l}}^{n+1,k}_{d, j-\onehalf}}{\ave{\alpha_{l} \rho_{l}}^{n}_{a, j - \onehalf}} & = & 0 \\
%
\label{eqn:advection_of_gas_energy}
V_{c,j}\frac{(\alpha_g \rho_g h_g)^{n+1, k}_{j} - (\alpha_g \rho_g h_g)^{n}_{j} }{ \dt } + \dot{m}^{n+1, k}_{g, j + \onehalf}\frac{\don{\alpha^n_g \rho^n_g h^{n}_{g}}^{n+1,k}_{d, j+\onehalf}}{\ave{\alpha_{g} \rho_{g}}^{n}_{a, j + \onehalf}} - \dot{m}^{n+1, k}_{g, j - \onehalf}\frac{\don{\alpha^{n}_{g} \rho^{n}_{g} h^{n}_{g}}^{n+1,k}_{d, j-\onehalf}}{\ave{\alpha_{g} \rho_{g}}^{n}_{a, j - \onehalf}} &  & \\
%
\nonumber
- V_{c,j} \alpha^{n}_{g} \frac{P^{\, n+1, k}_{j} - P^{\,n}_{j} }{\dt{}} & = & 0 \\
\label{eqn:advection_of_liq_energy}
V_{c,j}\frac{(\alpha_{l} \rho_{l} h_{l})^{n+1, k}_{j} - (\alpha_{l} \rho_{l} h_{l} )^{n}_{j} }{ \dt } + \dot{m}^{n+1, k}_{l, j + \onehalf}\frac{\don{\alpha^{n}_{l} \rho^{n}_{l} h^{n}_{l} }^{n+1, k}_{d, j+\onehalf}}{\ave{\alpha_{l} \rho_{l}}^{n}_{a, j + \onehalf}} - \dot{m}^{n+1, k}_{l, j - \onehalf}\frac{\don{\alpha^{n}_{l} \rho^{n}_{l} h^{n}_{l}}^{n+1, k}_{d, j-\onehalf}}{\ave{\alpha_{l} \rho_{l}}^{n}_{a, j - \onehalf}} &  &  \\
%
\nonumber
+ \dot{m}^{n+1, k}_{e, j + \onehalf}\frac{\don{\alpha^{n}_{e} \rho^{n}_{l} h^{n}_{l}}^{n+1, k}_{d, j+\onehalf}}{\ave{\alpha_{e} \rho_{l}}^{n}_{a, j + \onehalf}} - \dot{m}^{n+1, k}_{e, j - \onehalf}\frac{\don{\alpha^{n}_{e} \rho^{n}_{l} h^{n}_{l}}^{n+1, k}_{d, j-\onehalf}}{\ave{\alpha_{e} \rho_{l}}^{n}_{a, j - \onehalf}} - V_{c,j} ( 1 - \alpha^{n}_{g})\frac{P^{\, n+1, k}_{j} - P^{\,n}_{j} }{\dt{}}& = & 0 \\
%
\label{eqn:advection_of_ent_mass}
V_{c,j}\frac{(\alpha_{e} \rho_{l})^{n+1, k}_{j} - (\alpha_{e} \rho_{l})^{n}_{j} }{ \dt } + \dot{m}^{n+1, k}_{e, j + \onehalf}\frac{\don{\alpha^{n}_{e} \rho^{n}_{l}}^{n+1,k}_{d, j+\onehalf}}{\ave{\alpha_{e} \rho_{l}}^{n}_{a, j + \onehalf}} - \dot{m}^{n+1, k}_{e, j - \onehalf}\frac{\don{\alpha^{n}_{e} \rho^{n}_{l}}^{n+1,k}_{d, j-\onehalf}}{\ave{\alpha_{e}\rho_{l}}^{n}_{a, j - \onehalf}} & = & 0 \\
%
\label{eqn:advection_of_vap_mass}
V_{c,j}\frac{(\alpha_{g} \rho_{v})^{n+1, k}_{j} - (\alpha_{g} \rho_{v})^{n}_{j} }{ \dt } + \dot{m}^{n+1, k}_{g, j + \onehalf}\frac{\don{\alpha^{n}_{g} \rho^{n}_{v}}^{n+1,k}_{d, j+\onehalf}}{\ave{\alpha_{g} \rho_{g}}^{n}_{a, j + \onehalf}} - \dot{m}^{n+1, k}_{g, j - \onehalf}\frac{\don{\alpha^{n}_{g} \rho^{n}_{v}}^{n+1,k}_{d, j-\onehalf}}{\ave{\alpha_{g} \rho_{g}}^{n}_{a, j - \onehalf}} & = & 0
\end{IEEEeqnarray}

It will be advantageous to a matrix, $\vec{\Xi}$, that converts the momenta at a continuity volume's edge to fluxes of mass and energy; \eqref{eqn:flux_matrix} will serve this purpose.

\begin{equation}
\label{eqn:flux_matrix}
\vec{\Xi}^{n+1, k}_{j \pm \onehalf} = \begin{bmatrix}
%
 0 & \frac{\don{\alpha^{n}_{g} \rho^{n}_{n}}^{n+1,k}_{d}}{\ave{\alpha_{g} \rho_{g}}^{n}_{a}} & 0 \\
%
\frac{\don{\alpha^{n}_{l}\rho^{n}_{l}}^{n+1,k}_{d}}{\ave{\alpha_{l} \rho_{l}}^{n}_{a}} & 0 & 0 \\
%
0 & \frac{\don{\alpha^{n}_{g} \rho^{n}_{g} h^{n}_{g}}^{n+1,k}_{d}}{\ave{\alpha_{g} \rho_{g}}^{n}_{a}} & 0 \\
%
\frac{\don{\alpha^{n}_{l}\rho^{n}_{l} h^{n}_{l}}^{n+1,k}_{d}}{\ave{\alpha_{l} \rho_{l}}^{n}_{a}} & 0 & \frac{\don{\alpha^{n}_{e} \rho^{n}_{l} h^{n}_{l}}^{n+1, k}_{d}}{\ave{\alpha_{e} \rho_{l}}^{n}_{a}} \\
%
0 & 0 & \frac{ \don{\alpha^{n}_{e} \rho^{n}_{l}}^{n+1, k}_{d}}{ \ave{\alpha_{e} \rho_{l}}^{n}_{a}} \\
%
0 & \frac{ \don{\alpha^{n}_{g} \rho^{n}_{v}}^{n+1, k}_{d}}{ \ave{\alpha_{g} \rho_{g}}^{n}_{a}} & 0
\end{bmatrix}_{j \pm \onehalf}
\end{equation}

The momenta vector is given by \eqref{eqn:momenta_vector}.

\begin{equation}
\label{eqn:momenta_vector}
\vec{\dot{m}} = \begin{bmatrix}
\dot{m}_{l} \\
\dot{m}_{g} \\
\dot{m}_{e}
\end{bmatrix}
\end{equation}

The fluxes into or out of a given volume will be denoted by $\vec{\Psi}$, \eqref{eqn:flux_vector}.

\begin{equation}
\label{eqn:flux_vector}
\vec{\Psi} = \vec{\Xi} \cdot \vec{\dot{m}}
\end{equation}

With \eqref{eqn:flux_matrix} through \eqref{eqn:flux_vector}, \eqref{eqn:advection_of_ncg_mass} -- \eqref{eqn:advection_of_vap_mass} can be written as the vector of equations \eqref{eqn:short_hand_continuity}.

\begin{equation}
\label{eqn:short_hand_continuity}
\frac{V_j}{\dt} \begin{bmatrix}
(\alpha_{g} \rho_{n})^{n+1, k}_{j} - (\alpha_{g} \rho_{n})^{n}_{j} \\
\alpha_{l} \rho_{l})^{n+1, k}_{j} - (\alpha_{l} \rho_{l})^{n}_{j} \\
(\alpha_{g} \rho_{g} h_{g})^{n+1, k}_{j} - (\alpha_{g} \rho_g h_{g})^{n}_{j} - \alpha^{n}_{g} ( P^{\, n+1, k}_{j} - P^{\,n}_{j} )  \\
(\alpha_{l} \rho_{l} h_{l})^{n+1, k}_{j} - (\alpha_{l} \rho_{l} h_{l} )^{n}_{j} - (1 - \alpha^{n}_{g}) ( P^{\, n+1, k}_{j} - P^{\,n}_{j} )\\
(\alpha_{e} \rho_{l})^{n+1, k}_{j} - (\alpha_{e} \rho_{l})^{n}_{j} \\
(\alpha_{g} \rho_{v})^{n+1, k}_{j} - (\alpha_{g} \rho_{v})^{n}_{j} 
\end{bmatrix} + \vec{\Psi}^{n+1, k}_{j + \onehalf} - \vec{\Psi}^{n+1, k}_{j - \onehalf}= 0
\end{equation}

The residuals of the continuity equations at a given point, \eqref{eqn:short_hand_continuity}, will be known as $\vec{F}_{c, j}$.
Let the Jacobian of \eqref{eqn:short_hand_continuity} with respect to the associated nonlinear parameters as defined in \eqref{eqn:independentVariables} be defined as $J^{k}_{c, j}$.
The Jacobian of \eqref{eqn:short_hand_continuity} with respect to adjacent momenta, \eqref{eqn:momenta_vector}, is given by $\vec{\Xi}^{k}_{c, j \pm \onehalf}$.
The domain decomposition method is based upon fluxes into and out of a domain.

Up to this point, the discussion of the linear and nonlinear algorithms have avoided the use of full nonlinear system.
However, it is now time to venture into unknown territories.
For this example, imagine the following model:

\comment{HERE THERE IS A PICTURE OF TWO VOLUMES VERTICALLY CONNECTED.}

The following procedure will show the development of a single domain newton step.

\begin{equation}
\label{eqn:domainMatrix}
 \begin{bmatrix} 
\vec{J}_{c_1} & \vec{\Xi}_{c_1,m_1} & \vec{0} \\
\vec{J}_{m_1,c_1} & \vec{J}_{m_1} & \vec{J}_{m_1,c_2}  \\
\vec{0} & \vec{\Xi}_{c_2,m_1} & \vec{J}_{c_2} \\
 \end{bmatrix} \begin{bmatrix}
 \vec{\delta c}_{1} \\
 \vec{\delta m}_{1} \\
 \vec{\delta c}_{2} \\
\end{bmatrix}  = -\begin{bmatrix}
 \vec{F}_{c_1} \\
 \vec{F}_{m_1} \\
 \vec{F}_{c_2} \\
\end{bmatrix}
 \end{equation}
 
 \begin{equation}
\label{eqn:domainMatrix2}
 \begin{bmatrix} 
\vec{J}_{c_1} & \vec{\Xi}_{c_1,m_1} & \vec{0} \\
\frac{\partial \dot{\vec{m}}_{1}}{\partial P_{1} } & \vec{I} & \frac{\partial \dot{\vec{m}}_{1}}{\partial P_{2} }  \\
\vec{0} & \vec{\Xi}_{c_2,m_1} & \vec{J}_{c_2} \\
 \end{bmatrix} \begin{bmatrix}
 \vec{\delta c}_{1} \\
 \vec{\delta m}_{1} \\
 \vec{\delta c}_{2} \\
\end{bmatrix}  = \begin{bmatrix}
 - \vec{F}_{c_1} \\
 \delta \dot{\vec{m}}^{*} \\
 - \vec{F}_{c_2} \\
\end{bmatrix}
 \end{equation}
 
  
 \begin{equation}
\label{eqn:domainMatrix3}
 \begin{bmatrix} 
\vec{I} & \frac{\partial \dot{\vec{m}}_{1}}{\partial P_{1} } & \frac{\partial \dot{\vec{m}}_{1}}{\partial P_{2} }  \\
\vec{0} & \vec{J}_{c_1} - \vec{\Xi}_{c_1,m_1} \frac{\partial \dot{\vec{m}}_{1}}{\partial P_{1} } & - \vec{\Xi}_{c_1,m_1} \frac{\partial \dot{\vec{m}}_{1}}{\partial P_{2} }  \\
\vec{0} & -\vec{\Xi}_{c_2,m_1}\frac{\partial \dot{\vec{m}}_{1}}{\partial P_{1} } & \vec{J}_{c_2} - \vec{\Xi}_{c_2,m_1}\frac{\partial \dot{\vec{m}}_{1}}{\partial P_{2} } \\
 \end{bmatrix} \begin{bmatrix}
 \vec{\delta m}_{1} \\
 \vec{\delta c}_{1} \\
 \vec{\delta c}_{2} \\
\end{bmatrix}  = \begin{bmatrix}
 \delta \dot{\vec{m}}^{*} \\
 - ( \vec{F}_{c_1} + \vec{\Xi}_{c_1,m_1} \delta \dot{\vec{m}}^{*} ) \\
 - ( \vec{F}_{c_2} + \vec{\Xi}_{c_2,m_1} \delta \dot{\vec{m}}^{*} )\\
\end{bmatrix}
 \end{equation}

 \begin{equation}
\label{eqn:domainMatrix4}
 \begin{bmatrix} 
\vec{U}_{c_1} & - \vec{L}_{c_1}^{-1} \vec{\Xi}_{c_1,m_1} \frac{\partial \dot{\vec{m}}_{1}}{\partial P_{2} }  \\
-\vec{L}_{c_2}^{-1} \vec{\Xi}_{c_2,m_1}\frac{\partial \dot{\vec{m}}_{1}}{\partial P_{1} } & \vec{U}_{c_2} \\
 \end{bmatrix} \begin{bmatrix}
 \vec{\delta c}_{1} \\
 \vec{\delta c}_{2} \\
\end{bmatrix}  = \begin{bmatrix}
 - \vec{L}_{c_1}^{-1} ( \vec{F}_{c_1} + \vec{\Xi}_{c_1,m_1} \delta \dot{\vec{m}}^{*} ) \\
 - \vec{L}_{c_2}^{-1} ( \vec{F}_{c_2} + \vec{\Xi}_{c_2,m_1} \delta \dot{\vec{m}}^{*} )\\
\end{bmatrix}
 \end{equation}
 
  \begin{equation}
\label{eqn:domainMatrix5}
 \begin{bmatrix} 
1 & c_{1,2}  \\
c_{2,1} & 1 \\
 \end{bmatrix} \begin{bmatrix}
 \delta P_{1} \\
 \delta P_{2} \\
\end{bmatrix}  = \begin{bmatrix}
 f_1 \\
 f_2 \\
\end{bmatrix}
 \end{equation}
 
 The following is the domain decomposition version.
 
 \begin{equation}
\label{eqn:domainDecomp0}
 \begin{bmatrix} 
\vec{J}_{c_1} & \vec{\Xi}_{c_1,m_1} & \vec{0} \\
\vec{J}_{m_1,c_1} & \vec{J}_{m_1} & \vec{J}_{m_1,c_2}  \\
\vec{0} & \vec{\Xi}_{c_2,m_1} & \vec{J}_{c_2} \\
 \end{bmatrix} \begin{bmatrix}
 \vec{\delta c}_{1} \\
 \vec{\delta m}_{1} \\
 \vec{\delta c}_{2} \\
\end{bmatrix}  = -\begin{bmatrix}
 \vec{F}_{c_1} \\
 \vec{F}_{m_1} \\
 \vec{F}_{c_2} \\
\end{bmatrix}
 \end{equation}
 
 \begin{equation}
\label{eqn:domainDecomp1}
 \begin{bmatrix} 
\vec{J}_{c_1} & \vec{0} & - \vec{\Xi}_{m_1} & \vec{0} \\
\vec{0} & \vec{I} & \vec{\Xi}_{m_1} & 0 \\
\vec{J}_{m_1,c_1} & \vec{0} & \vec{J}_{m_1} & \vec{J}_{m_1,c_2}  \\
\vec{0} & \vec{0} & \vec{\Xi}_{m_1} & \vec{J}_{c_2} \\
 \end{bmatrix} \begin{bmatrix}
 \vec{\delta c}_{1} \\
 \vec{\delta \Psi}_{1} \\
 \vec{\delta m}_{1} \\
 \vec{\delta c}_{2} \\
\end{bmatrix}  = -\begin{bmatrix}
 \vec{F}_{c_1} \\
 \vec{0} \\
 \vec{F}_{m_1} \\
 \vec{F}_{c_2} \\
\end{bmatrix}
 \end{equation} 
 
 \begin{equation}
\label{eqn:domainDecomp2}
 \begin{bmatrix} 
\vec{J}_{c_1} & \vec{I} & \vec{0} & \vec{0} \\
\vec{0} & \vec{I} & \vec{\Xi}_{m_1} & 0 \\
\vec{J}_{m_1,c_1} & \vec{0} & \vec{J}_{m_1} & \vec{J}_{m_1,c_2}  \\
\vec{0} & \vec{0} & \vec{\Xi}_{m_1} & \vec{J}_{c_2} \\
 \end{bmatrix} \begin{bmatrix}
 \vec{\delta c}_{1} \\
 \vec{\delta \Psi}_{1} \\
 \vec{\delta m}_{1} \\
 \vec{\delta c}_{2} \\
\end{bmatrix}  = -\begin{bmatrix}
 \vec{F}_{c_1} \\
 \vec{0} \\
 \vec{F}_{m_1} \\
 \vec{F}_{c_2} \\
\end{bmatrix}
 \end{equation}
 
  
 \begin{equation}
\label{eqn:domainDecomp3}
 \begin{bmatrix} 
\vec{J}_{c_1} & \vec{I} & \vec{0} & \vec{0} \\
\vec{0} & \vec{I} & \vec{\Xi}_{m_1} & 0 \\
\frac{\partial \dot{\vec{m}}_{1}}{\partial P_{1} } & \vec{0} & \vec{I} & \frac{\partial \dot{\vec{m}}_{1}}{\partial P_{2} }  \\
\vec{0} & \vec{0} & \vec{\Xi}_{m_1} & \vec{J}_{c_2} \\
 \end{bmatrix} \begin{bmatrix}
 \vec{\delta c}_{1} \\
 \vec{\delta \Psi}_{1} \\
 \vec{\delta m}_{1} \\
 \vec{\delta c}_{2} \\
\end{bmatrix}  = \begin{bmatrix}
 - \vec{F}_{c_1} \\
 \vec{0} \\
 \delta \dot{\vec{m}}^{*} \\
 - \vec{F}_{c_2} \\
\end{bmatrix}
 \end{equation}

 \begin{equation}
\label{eqn:domainDecomp4}
 \begin{bmatrix} 
\vec{J}_{c_1} & \vec{I} & \vec{0} & \vec{0} \\
- \vec{\Xi}_{m_1}\frac{\partial \dot{\vec{m}}_{1}}{\partial P_{1} } & \vec{I} & \vec{0} & -\vec{\Xi}_{m_1}\frac{\partial \dot{\vec{m}}_{1}}{\partial P_{2} } \\
\frac{\partial \dot{\vec{m}}_{1}}{\partial P_{1} } & \vec{0} & \vec{I} & \frac{\partial \dot{\vec{m}}_{1}}{\partial P_{2} }  \\
\vec{0} & \vec{0} & \vec{\Xi}_{m_1} & \vec{J}_{c_2} \\
 \end{bmatrix} \begin{bmatrix}
 \vec{\delta c}_{1} \\
 \vec{\delta \Psi}_{1} \\
 \vec{\delta m}_{1} \\
 \vec{\delta c}_{2} \\
\end{bmatrix}  = \begin{bmatrix}
 - \vec{F}_{c_1} \\
 - \vec{\Xi}_{m_1} \delta \dot{\vec{m}}^{*} \\
 \delta \dot{\vec{m}}^{*} \\
 - \vec{F}_{c_2} \\
\end{bmatrix}
 \end{equation}
 
  \begin{equation}
\label{eqn:domainDecomp5}
 \begin{bmatrix} 
1 & c_{1,2}  \\
c_{2,1} & 1 \\
 \end{bmatrix} \begin{bmatrix}
 \delta P_{1} \\
 \delta P_{2} \\
\end{bmatrix}  = \begin{bmatrix}
 f_1 \\
 f_2 \\
\end{bmatrix}
 \end{equation}
 
\comment{
This is annoying as crap to describe.
I will give it a shot in words.
}

First, the input file is specified in the following way 
'begin-nln-channels'
01
'end-nln-channels'


The procedures that were written to determine which continuity volumes were active and which were inactive was modified to 

When formulating the governing equations, the fluxes between the linear and nonlinear domains are treated as additional nonlinear variables.
When the linear domain is formulated, these flux terms are treated as variational parameters within the continuity volumes in the linear domain that lie on the boundary of the nonlinear domain.
Take for example a continuity volume with only two flowpaths connected to it.
One flow path is connected to another continuity volume within the linear domain.
The other flow path is connected to a continuity volume that resides within the nonlinear domain.
When the Jacobian for these continuity volumes are taken, derivatives with respect to the flux terms are included.

\begin{equation}
\label{eqn:jacobianWithFluxTerms}
\begin{bmatrix}
\frac{\partial F_{m,n}}{\partial (\alpha_g P_{n})} & \frac{\partial F_{m,n}}{\partial \alpha_g } & \frac{\partial F_{m,n}}{\partial (\alpha_g h_v)} & \frac{\partial F_{m,n}}{\partial ((1.0 - \alpha_g) h_l) } & \frac{\partial F_{m,n}}{\partial \alpha_e } & \frac{\partial F_{m,n}}{\partial P } \\
\frac{\partial F_{m,l}}{\partial (\alpha_g P_{n})} & \frac{\partial F_{m,l}}{\partial \alpha_g } & \frac{\partial F_{m,l}}{\partial (\alpha_g h_v)} & \frac{\partial F_{m,l}}{\partial ((1.0 - \alpha_g) h_l)} &\frac{\partial F_{m,l}}{\partial \alpha_e } & \frac{\partial F_{m,l}}{\partial P } \\
\frac{\partial F_{e,g}}{\partial (\alpha_g P_{n})} & \frac{\partial F_{e,g}}{\partial \alpha_g } & \frac{\partial F_{e,g}}{\partial (\alpha_g h_v)} & \frac{\partial F_{e,g}}{\partial ((1.0 - \alpha_g) h_l)} &\frac{\partial F_{e,g}}{\partial \alpha_e } & \frac{\partial F_{e,l}}{\partial P } \\
\frac{\partial F_{e,l}}{\partial (\alpha_g P_{n})} & \frac{\partial F_{e,l}}{\partial \alpha_g } & \frac{\partial F_{e,l}}{\partial (\alpha_g h_v)} & \frac{\partial F_{e,l}}{\partial ((1.0 - \alpha_g) h_l)} &\frac{\partial F_{e,l}}{\partial \alpha_e } & \frac{\partial F_{e,g}}{\partial P } \\
\frac{\partial F_{m,e}}{\partial (\alpha_g P_{n})} & \frac{\partial F_{m,e}}{\partial \alpha_g } & \frac{\partial F_{m,e}}{\partial (\alpha_g h_v)} & \frac{\partial F_{m,e}}{\partial ((1.0 - \alpha_g) h_l)} &\frac{\partial F_{m,e}}{\partial \alpha_e } & \frac{\partial F_{m,e}}{\partial P } \\
\frac{\partial F_{m,v}}{\partial (\alpha_g P_{n})} & \frac{\partial F_{m,v}}{\partial \alpha_g } & \frac{\partial F_{m,v}}{\partial (\alpha_g h_v)} & \frac{\partial F_{m,v}}{\partial ((1.0 - \alpha_g) h_l)} & \frac{\partial F_{m,v}}{\partial \alpha_e } & \frac{\partial F_{m,v}}{\partial P }
\end{bmatrix}
= 2
\end{equation}
 
 

%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
\section{Implementation in \cobra{}}
\label{sec:dd_algo}

The algorithmic implementation of the domain decomposition algorithm is now detailed.
This is going to be long.
Supposedly.

I am a single volume:

\begin{figure}[ht]
\centering
\input{images/isoparametric_volume}
\caption{A single continuity volume.}
\label{fig:single3dvol}
\end{figure}


%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
%-------------------------------------------------------------------------------
\section{Algorithmic Considerations}
\label{sect:dd_algo_con}

Are there any algorithmic considerations?
I am sure there are.
